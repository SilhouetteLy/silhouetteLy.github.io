I"¶û<h2 id="ä¸€solr-æ¦‚è¿°">ä¸€ã€Solr æ¦‚è¿°</h2>

<h4 id="11-solr-ç®€ä»‹">1.1 Solr ç®€ä»‹</h4>

<ul>
  <li>Solrï¼š<code class="highlighter-rouge">Solr æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½ï¼Œé‡‡ç”¨ Java5 å¼€å‘ï¼ŒåŸºäº Lucene çš„å…¨æ–‡æœç´¢æœåŠ¡å™¨</code>ã€‚åŒæ—¶å¯¹å…¶è¿› è¡Œäº†æ‰©å±•ï¼Œæä¾›äº†æ¯” Lucene æ›´ä¸ºä¸°å¯Œçš„æŸ¥è¯¢è¯­è¨€ï¼ŒåŒæ—¶å®ç°äº†å¯é…ç½®ã€å¯æ‰©å±•å¹¶å¯¹æŸ¥è¯¢æ€§ èƒ½è¿›è¡Œäº†ä¼˜åŒ–ï¼Œå¹¶ä¸”æä¾›äº†ä¸€ä¸ªå®Œå–„çš„åŠŸèƒ½ç®¡ç†ç•Œé¢ï¼Œæ˜¯ä¸€æ¬¾éå¸¸ä¼˜ç§€çš„å…¨æ–‡æœç´¢å¼•æ“ã€‚</li>
  <li>ä¸‹è½½ï¼šSolr æ˜¯ Apache ä¸‹çš„ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œç”±äºæ˜¯åŸºäº Lucene çš„ä¸€ä¸ªå®ç°äº§å“ï¼Œå› æ­¤å°† Solr æ”¾åœ¨ Lucene é¡¹ç›®å½“ä¸­ã€‚å¯ä»¥åœ¨<a href="https://lucene.apache.org/solr/">å®˜æ–¹ç½‘ç«™</a>çš„<a href="http://archive.apache.org/dist/lucene/solr/">å†å²ç‰ˆæœ¬</a>ä¸­ä¸‹è½½æˆ‘ä»¬éœ€è¦çš„ç‰ˆæœ¬ã€‚æ­¤å¤„ä»¥<strong>4.10.2</strong>ä¸ºä¾‹</li>
  <li>ç›®å½•ç»“æ„
    <ul>
      <li>contrib/distï¼šå­˜æ”¾Solr æ’ä»¶ä¾èµ–çš„ jar åŒ…</li>
      <li>exampleï¼šå­˜æ”¾Solrå†…ç½®å®ä¾‹
        <ul>
          <li>Solr ç›®å½•ç”¨æ¥å­˜æ”¾ Solr çš„ Coreï¼Œä¸»è¦åŒ…å«ç´¢å¼•å’Œé…ç½®æ–‡ä»¶ã€‚</li>
          <li>solr-webapp ç›®å½•ä¸­ç®¡ç†è€… Jetty è¿è¡Œçš„ Solr æœåŠ¡å»ç¨‹åºã€‚</li>
          <li>Webapps ç›®å½•ä¸­çš„ solr.war ä¸º solr æœåŠ¡çš„æ–‡æœ¬åº”ç”¨ç¨‹åºã€‚</li>
          <li>start.jarï¼šå†…ç½® Jetty æœåŠ¡å™¨ï¼Œå¯ä»¥ç›´æ¥è¿è¡ŒSolr æœåŠ¡</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h4 id="12-è¿è¡Œ-solr-æœåŠ¡">1.2 è¿è¡Œ Solr æœåŠ¡</h4>

<p>Solr å®é™…ä¸Šæ˜¯ä¸€ä¸ª web æœåŠ¡å™¨åº”ç”¨ç¨‹åºï¼Œå› æ­¤è¦å¯åŠ¨ Solr éœ€è¦æ–‡æœ¬æœåŠ¡å™¨ï¼Œè€Œåœ¨ Solr å®ä¾‹ä»£ç ä¸­å·²ç»ç›´æ¥é›†æˆäº† Jetty æœåŠ¡å™¨ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œ ä¹Ÿå¯ä»¥å•ç‹¬é…ç½®å’Œä½¿ç”¨ Tomcat æœåŠ¡å™¨æ¥å¯åŠ¨ Solr æœåŠ¡ã€‚</p>

<ul>
  <li>
    <p>å¯åŠ¨ Solr æœåŠ¡çš„æ–¹å¼</p>

    <ul>
      <li>
        <p>ä½¿ç”¨ Solr <code class="highlighter-rouge">å†…ç½®çš„ Jetty æœåŠ¡å™¨</code>å¯åŠ¨ Solr</p>

        <ol>
          <li>
            <p>ä½¿ç”¨å†…ç½®çš„ Jetty æ¥å¯åŠ¨ Solr æœåŠ¡å™¨åªéœ€è¦åœ¨ example ç›®å½•ä¸‹ï¼Œæ‰§è¡Œ start.jar ç¨‹åºå³å¯ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æ‰§è¡Œå‘½ä»¤ï¼š</p>

            <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>java â€“jar start.jar
</code></pre></div>            </div>
          </li>
          <li>
            <p>å½“æœåŠ¡å¯åŠ¨åï¼Œé»˜è®¤å‘å¸ƒåœ¨ <code class="highlighter-rouge">8983</code> ç«¯å£ï¼Œæ‰€ä»¥å¯ä»¥è®¿é—®è¯¥ç«¯å£æ¥è®¿é—® Solr æœåŠ¡ã€‚</p>
          </li>
        </ol>
      </li>
      <li>
        <p>å°† Solr éƒ¨ç½²åˆ° Tomcat ä¸­</p>

        <ol>
          <li>
            <p>åœ¨ Tomcat ä¸­éƒ¨ç½² Web æœåŠ¡ï¼Œå°† solr-4.10.2/example/webapps/solr.war å¤åˆ¶åˆ°è‡ª å·±çš„ tomcat/webapps ç›®å½•ä¸­ï¼Œè§£å‹åç§»é™¤waråŒ…(å› ä¸ºæ¯æ¬¡æœåŠ¡å™¨é‡æ–°å¯åŠ¨åï¼Œä¼šè¢«è¦†ç›–)ã€‚</p>

            <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd</span> /home/silhouette/solr-4.10.2/example/webapps
<span class="nv">$ </span><span class="nb">cp </span>solr.war /home/silhouette/apache-tomcat-8.5.38/webapps/ 
<span class="nv">$ </span> unzip solr.war <span class="nt">-d</span> solr
</code></pre></div>            </div>
          </li>
          <li>
            <p>è§£å‹åSolrè¿˜ä¸èƒ½ç›´æ¥è®¿é—®ï¼Œå› ä¸ºç¼ºå°‘ç›¸åº”çš„jaråŒ…ï¼Œæ‰€ä»¥éœ€è¦å°† Solr ç”¨åˆ°çš„ jar åŒ…æ‹·è´åˆ°é¡¹ç›®çš„ lib ç›®å½•ä¸‹</p>

            <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd</span> /home/silhouette/solr-4.10.2/example/lib/ext
<span class="nv">$ </span><span class="nb">cp</span> <span class="k">*</span> /home/silhouette/apache-tomcat-8.5.38/webapps/solr/WEB-INF/lib/
<span class="nv">$ </span><span class="nb">cd</span> /home/silhouette/solr-4.10.2/example/resources
<span class="nv">$ </span><span class="nb">cp </span>log4j.properties /home/silhouette/apache-tomcat-8.5.38/webapps/solr/WEB-INF/classes
</code></pre></div>            </div>
          </li>
          <li>
            <p>æ‹·è´Solr çš„ç´¢å¼•ç›®å½•ã€‚</p>
          </li>
        </ol>

        <ul>
          <li>
            <p>å°† Solr ç”¨åˆ°çš„ jar åŒ…æ‹·è´åˆ°é¡¹ç›®çš„ lib ç›®å½•ä¸‹æˆ–è€…åªæƒ³æ‰€åœ¨ç›®å½•ï¼Œåœ¨å¯åŠ¨å‰è¿˜éœ€è¦è®¾ç½® solr.solr.home å¯åŠ¨å‚æ•°ï¼Œåœ¨ catalina.bat æ–‡ä»¶æ·»åŠ é…ç½®ï¼š</p>

            <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">mkdir </span>solr_home
<span class="nv">$ </span><span class="nb">cd </span>solr_home
<span class="nv">$ </span><span class="nb">cp</span> <span class="nt">-r</span> ../example/solr ./
<span class="nv">$ </span>vim catalina.sh
<span class="nv">$ </span><span class="nb">set</span> <span class="s2">"JAVA_OPTS=-Dsolr.solr.home=/Users/silhouette/software/apache/solr/solr-4.10.2/solr_home/solr"</span>
<span class="c">####Linux ç¯å¢ƒä¸‹</span>
<span class="nv">$ </span><span class="nb">export</span> <span class="s2">"JAVA_OPTS=-Dsolr.solr.home=/Users/silhouette/software/apache/solr/solr-4.10.2/solr_home/solr"</span>
</code></pre></div>            </div>
          </li>
          <li>
            <p>å¯åŠ¨ Tomcat åˆ™ Solr çš„æœåŠ¡å™¨å‘å¸ƒå°±å®Œæˆäº†ã€‚</p>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h4 id="13-solr-ç®¡ç†ç•Œé¢">1.3 Solr ç®¡ç†ç•Œé¢</h4>

<p><code class="highlighter-rouge">solr </code>æœåŠ¡å™¨ç®¡ç†ç•Œé¢å¯ä»¥æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€ã€solrè®¾ç½®ã€åˆ†è¯æ£€æµ‹ã€æŸ¥è¯¢ç´¢å¼•ã€å¢å‡coreã€æŸ¥çœ‹æ—¥å¿—ç­‰</p>

<ul>
  <li>
    <p>DashBoard(ä»ªè¡¨ç›˜)</p>

    <ul>
      <li>
        <p>æŸ¥çœ‹åˆ°solrè¿è¡Œæ—¶é—´ã€solrç‰ˆæœ¬ï¼Œç³»ç»Ÿå†…å­˜ã€è™šæ‹Ÿæœºå†…å­˜çš„ä½¿ç”¨æƒ…å†µ</p>

        <p><img src="/img/images/Full-text_Search/solr/00/01-DashBoard.png" /></p>
      </li>
    </ul>
  </li>
  <li>
    <p>Logging(æ—¥å¿—)</p>

    <ul>
      <li>
        <p>æ˜¾ç¤ºsolrè¿è¡Œå‡ºç°çš„å¼‚å¸¸æˆ–é”™è¯¯</p>

        <p><img src="/img/images/Full-text_Search/solr/00/02-Logging.png" /></p>
      </li>
    </ul>
  </li>
  <li>
    <p>Core Admin</p>

    <ul>
      <li>
        <p>åœ¨ Solr ä¸­ï¼Œæ¯ä¸€ä¸ª Coreï¼Œä»£è¡¨ä¸€ä¸ªç´¢å¼•åº“ï¼Œé‡Œé¢åŒ…å«ç´¢å¼•æ•°æ®åŠå…¶ä¿¡æ¯ã€‚Solr ä¸­å¯ä»¥ æ‹¥æœ‰å¤šä¸ª Coreï¼Œä¹Ÿå°±åŒæ—¶ç®¡ç†å¤šä¸ªç´¢å¼•åº“ï¼å°±åƒåœ¨ MySQL ä¸­å¯ä»¥æœ‰å¤šä¸ª database ä¸€æ ·ã€‚</p>

        <p><img src="/img/images/Full-text_Search/solr/00/03-Core Admin.png" /></p>

        <ul>
          <li>nameï¼šç»™coreèµ·çš„åå­—ï¼›</li>
          <li>instanceDirï¼šä¸æˆ‘ä»¬åœ¨é…ç½®solrç´¢å¼•åº“æ—¶çš„solr_homeé‡Œæ–°å»ºçš„coreæ–‡ä»¶å¤¹åä¸€è‡´ï¼›</li>
          <li>dataDir:ç¡®è®¤Add Coreæ—¶ï¼Œä¼šåœ¨new_coreç›®å½•ä¸‹ç”Ÿæˆåä¸ºdataçš„æ–‡ä»¶å¤¹</li>
          <li>configï¼šnew_coreä¸‹çš„confä¸‹çš„configé…ç½®æ–‡ä»¶(solrconfig.xml)</li>
          <li>schema: new_coreä¸‹çš„confä¸‹çš„schemaæ–‡ä»¶(schema.xml)</li>
        </ul>

        <blockquote>
          <p>Tipsï¼šå¯ä»¥ç›´æ¥æ‹·è´æœ¬åœ°çš„Collection1ç„¶åé‡å‘½åï¼Œå†ä¿®æ”¹core.propertiesæ–‡ä»¶å³å¯è¾¾åˆ°ç›¸åŒæ•ˆæœ</p>
        </blockquote>
      </li>
    </ul>
  </li>
  <li>
    <p>Java Properties</p>

    <ul>
      <li>å¯æŸ¥çœ‹åˆ°javaç›¸å…³çš„ä¸€äº›å±æ€§çš„ä¿¡æ¯</li>
    </ul>
  </li>
  <li>
    <p><strong>Core Selecter(coreé€‰æ‹©å™¨)</strong></p>

    <ul>
      <li>
        <p>éœ€è¦åœ¨Core Adminé‡Œæ·»åŠ äº†coreåæ‰æœ‰å¯é€‰é¡¹ï¼Œè¿™é‡Œä»¥é»˜è®¤çš„collection1ä¸ºä¾‹ã€‚</p>

        <p><img src="/img/images/Full-text_Search/solr/00/04-Core Selecter.png" /></p>
      </li>
      <li>
        <p>é€šè¿‡ Solr ç®¡ç†ç•Œé¢æŸ¥è¯¢ç´¢å¼•æ•°æ®</p>

        <p><img src="/img/images/Full-text_Search/solr/00/05-é€šè¿‡ Solr ç®¡ç†ç•Œé¢æŸ¥è¯¢ç´¢å¼•æ•°æ®.png" /></p>
      </li>
    </ul>
  </li>
</ul>

<h4 id="14-solrä¸­çš„coreè¯¦è§£">1.4 Solrä¸­çš„Coreè¯¦è§£</h4>

<ul>
  <li>
    <p>Core çš„æ¦‚è¿°ï¼šåœ¨Solr ä¸­ä¸€ä¸ª coreå°±æ˜¯ä¸€ä¸ªç´¢å¼•åº“ï¼Œé‡Œé¢åŒ…å«ç´¢å¼•ä¿¡æ¯å’Œé…ç½®æ–‡ä»¶ã€‚</p>
  </li>
  <li>
    <p>ç›®å½•ç»“æ„</p>

    <ul>
      <li>
        <p>confï¼šé…ç½®æ–‡ä»¶ç›®å½•</p>

        <ul>
          <li>
            <p>schema.xmlï¼šå­—æ®µåŠå­—æ®µçº¦æŸä¿¡æ¯ï¼Œå¦‚ï¼šå­—æ®µæ•°æ®ç±»å‹ã€å­—æ®µæ˜¯å¦ç´¢å¼•ã€æ˜¯å¦å­˜å‚¨ã€æ˜¯å¦åˆ†è¯ç­‰</p>

            <ul>
              <li>
                <p>é€šè¿‡<code class="highlighter-rouge">Field</code> å­—æ®µå®šä¹‰å­—æ®µçš„å±æ€§ä¿¡æ¯</p>

                <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- é…ç½®Fieldï¼Œå°±æ˜¯é…ç½®åœ¨Solrä¸­å¯ä»¥ä½¿ç”¨çš„å­—æ®µåç§°ã€‚å±æ€§åŠå«ä¹‰ï¼š
        nameï¼šå­—æ®µåç§° ã€_version_ã€_root_æ˜¯Solrç³»ç»Ÿä½¿ç”¨çš„ã€‘
        typeï¼šå­—æ®µç±»å‹ï¼ŒæŒ‡å‘çš„æ˜¯æœ¬æ–‡ä»¶ä¸­çš„&lt;fieldType&gt;æ ‡ç­¾ 
        indexedï¼šæ˜¯å¦åˆ›å»ºç´¢å¼• 
        storedï¼šæ˜¯å¦è¢«å­˜å‚¨ 
        multiValuedï¼šæ˜¯å¦å¯ä»¥æœ‰å¤šä¸ªå€¼ï¼Œå¦‚æœå­—æ®µå¯ä»¥æœ‰å¤šä¸ªå€¼ï¼Œè®¾ç½®ä¸º true
--&gt;</span>
<span class="nt">&lt;fieldType</span> <span class="na">name=</span><span class="s">"string"</span> <span class="na">class=</span><span class="s">"solr.StrField"</span> <span class="na">sortMissingLast=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
</code></pre></div>                </div>
              </li>
              <li>
                <p>é€šè¿‡ <code class="highlighter-rouge">FieldType</code> å­—æ®µæŒ‡å®šæ•°æ®ç±»å‹</p>

                <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!--
nameï¼šå­—æ®µç±»å‹çš„åç§°ï¼Œå¯ä»¥è‡ªå®šä¹‰ï¼Œ&lt;field&gt;æ ‡ç­¾çš„ type å±æ€§å¯ä»¥å¼•ç”¨è¯¥å­—æ®µï¼Œæ¥æŒ‡å®šæ•°æ®ç±»å‹
classï¼šå­—æ®µç±»å‹åœ¨ Solr ä¸­çš„ç±»ã€‚StrField å¯ç´¢å¼•ä¸å¯åˆ†è¯ã€‚TextField å­—æ®µå¯ç´¢å¼•ï¼Œå¯ä»¥åˆ†è¯ï¼Œ æ‰€ä»¥éœ€è¦æŒ‡å®šåˆ†è¯å™¨
&lt;analyzer&gt;ï¼šè¿™ä¸ªå­æ ‡ç­¾ç”¨æ¥æŒ‡å®šåˆ†è¯å™¨,
--&gt;</span>
<span class="nt">&lt;fieldType</span> <span class="na">name=</span><span class="s">"text_general"</span> <span class="na">class=</span><span class="s">"solr.TextField"</span> <span class="na">positionIncrementGap=</span><span class="s">"100"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;analyzer</span> <span class="na">type=</span><span class="s">"index"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;tokenizer</span> <span class="na">class=</span><span class="s">"solr.StandardTokenizerFactory"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;filter</span> <span class="na">class=</span><span class="s">"solr.StopFilterFactory"</span> <span class="na">ignoreCase=</span><span class="s">"true"</span> <span class="na">words=</span><span class="s">"stopwords.txt"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;filter</span> <span class="na">class=</span><span class="s">"solr.LowerCaseFilterFactory"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/analyzer&gt;</span>
    <span class="nt">&lt;analyzer</span> <span class="na">type=</span><span class="s">"query"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;tokenizer</span> <span class="na">class=</span><span class="s">"solr.StandardTokenizerFactory"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;filter</span> <span class="na">class=</span><span class="s">"solr.StopFilterFactory"</span> <span class="na">ignoreCase=</span><span class="s">"true"</span> <span class="na">words=</span><span class="s">"stopwords.txt"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;filter</span> <span class="na">class=</span><span class="s">"solr.SynonymFilterFactory"</span> <span class="na">synonyms=</span><span class="s">"synonyms.txt"</span> 
                <span class="na">ignoreCase=</span><span class="s">"true"</span> <span class="na">expand=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;filter</span> <span class="na">class=</span><span class="s">"solr.LowerCaseFilterFactory"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/analyzer&gt;</span>
<span class="nt">&lt;/fieldType&gt;</span>
</code></pre></div>                </div>

                <ul>
                  <li>
                    <p><code class="highlighter-rouge">é…ç½®ä½¿ç”¨IKåˆ†è¯å™¨</code></p>

                    <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!--å…ˆå°†IKåˆ†è¯å™¨çš„jaråŒ…æ”¾å…¥é¡¹ç›®çš„libç›®å½•ä¸­--&gt;</span>
<span class="nt">&lt;fieldType</span> <span class="na">name=</span><span class="s">"text_general"</span> <span class="na">class=</span><span class="s">"solr.TextField"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;analyzer</span> <span class="na">type=</span><span class="s">"index"</span> <span class="na">class=</span><span class="s">"org.wltea.analyzer.lucene.IKAnalyzer"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;analyzer</span> <span class="na">type=</span><span class="s">"query"</span> <span class="na">class=</span><span class="s">"org.wltea.analyzer.lucene.IKAnalyzer"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/fieldType&gt;</span>
</code></pre></div>                    </div>
                  </li>
                </ul>
              </li>
              <li>
                <p>é€šè¿‡<code class="highlighter-rouge">dynamicField</code>å­—æ®µæ¥å®šä¹‰åŠ¨æ€å­—æ®µ</p>

                <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!--è¡¨ç¤ºåªè¦æ»¡è¶³ç‰¹å®šçš„è§„åˆ™å°±å¯ä»¥ä½¿ç”¨--&gt;</span>
<span class="nt">&lt;dynamicField</span> <span class="na">name=</span><span class="s">"*_i"</span>  <span class="na">type=</span><span class="s">"int"</span>    <span class="na">indexed=</span><span class="s">"true"</span>  <span class="na">stored=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
</code></pre></div>                </div>
              </li>
              <li>
                <p>é€šè¿‡<code class="highlighter-rouge">uniqueKey</code>å­—æ®µæ¥é…ç½®å”¯ä¸€ä¸»é”®</p>

                <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!--Lucene ä¸­æœ¬æ¥æ˜¯æ²¡æœ‰ä¸»é”®çš„ã€‚åˆ é™¤å’Œä¿®æ”¹éƒ½éœ€è¦æ ¹æ®è¯æ¡è¿›è¡ŒåŒ¹é…ã€‚
è€Œ Solr å´å¯ä»¥è®¾ ç½®ä¸€ä¸ªå­—æ®µä¸ºå”¯ä¸€ä¸»é”®ï¼Œè¿™æ ·å¢åˆ æ”¹æ“ä½œéƒ½å¯ä»¥æ ¹æ®ä¸»é”®æ¥è¿›è¡Œã€‚--&gt;</span>
<span class="nt">&lt;uniqueKey&gt;</span>id<span class="nt">&lt;/uniqueKey&gt;</span>
</code></pre></div>                </div>
              </li>
            </ul>
          </li>
          <li>
            <p>Solrconfig.xmlï¼šç´¢å¼•åº“çš„ç›¸å…³é…ç½®</p>

            <ul>
              <li>
                <p>é€šè¿‡<code class="highlighter-rouge">&lt;lib/&gt;</code>æ ‡ç­¾æ¥é…ç½®æ’ä»¶ä¾èµ–çš„ jar åŒ…</p>

                <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!--
å¦‚æœå¼•å…¥å¤šä¸ª jar åŒ…ï¼Œè¦æ³¨æ„åŒ…å’ŒåŒ…çš„ä¾èµ–å…³ç³»ï¼Œè¢«ä¾èµ–çš„åŒ…é…ç½®åœ¨å‰é¢
è¿™é‡Œçš„ jar åŒ…ç›®å½•å¦‚æœæ˜¯ç›¸å¯¹è·¯å¾„ï¼Œç›¸å¯¹äº coreç´¢å¼•åº“ æ‰€åœ¨ç›®å½•
--&gt;</span>
<span class="nt">&lt;lib</span> <span class="na">dir=</span><span class="s">"../../../contrib/extraction/lib"</span> <span class="na">regex=</span><span class="s">".*\.jar"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;lib</span> <span class="na">dir=</span><span class="s">"../../../dist/"</span> <span class="na">regex=</span><span class="s">"solr-cell-\d.*\.jar"</span> <span class="nt">/&gt;</span>
</code></pre></div>                </div>
              </li>
              <li>
                <p>é€šè¿‡<code class="highlighter-rouge">&lt;requestHandler/&gt;</code>æ ‡ç­¾æ¥é…ç½® Solr å¤„ç†å„ç§è¯·æ±‚(æœç´¢/selectã€æ›´æ–°/updateã€ç­‰)çš„å„ç§å‚æ•°</p>

                <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!--ä¸»è¦å‚æ•°ï¼š
			nameï¼šè¯·æ±‚ç±»å‹ï¼Œä¾‹å¦‚ï¼šselectã€queryã€getã€update
			classï¼šå¤„ç†è¯·æ±‚çš„ç±»
			initParamsï¼šå¯é€‰ã€‚å¼•ç”¨&lt;initParams&gt;æ ‡ç­¾ä¸­çš„é…ç½®
			&lt;lst name="defaults"&gt;ï¼šå®šä¹‰å„ç§ç¼ºçœçš„é…ç½®ï¼Œæ¯”å¦‚ç¼ºçœçš„ parserã€ç¼ºçœè¿”å›æ¡æ•°
--&gt;</span>
<span class="nt">&lt;requestHandler</span> <span class="na">name=</span><span class="s">"/select"</span> <span class="na">class=</span><span class="s">"solr.SearchHandler"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;lst</span> <span class="na">name=</span><span class="s">"defaults"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;str</span> <span class="na">name=</span><span class="s">"echoParams"</span><span class="nt">&gt;</span>explicit<span class="nt">&lt;/str&gt;</span>
      <span class="nt">&lt;int</span> <span class="na">name=</span><span class="s">"rows"</span><span class="nt">&gt;</span>10<span class="nt">&lt;/int&gt;</span>
      <span class="nt">&lt;str</span> <span class="na">name=</span><span class="s">"df"</span><span class="nt">&gt;</span>text<span class="nt">&lt;/str&gt;</span>
  <span class="nt">&lt;/lst&gt;</span>
<span class="nt">&lt;/requestHandler&gt;</span>
</code></pre></div>                </div>
              </li>
            </ul>
          </li>
        </ul>
      </li>
      <li>
        <p>dataï¼šç´¢å¼•æ•°æ®ç›®å½•</p>
      </li>
      <li>
        <p>Core.propertiesï¼šcoreçš„è‡ªèº«å±æ€§ã€‚æ³¨æ„coreçš„nameå±æ€§ä¸å¤–é¢ç´¢å¼•æ–‡ä»¶åä¿æŒä¸€è‡´</p>
      </li>
    </ul>
  </li>
</ul>

<h4 id="15-é…ç½®ä¸­æ–‡åˆ†è¯å™¨ä¸ä¸šåŠ¡åŸŸ">1.5 é…ç½®ä¸­æ–‡åˆ†è¯å™¨ä¸ä¸šåŠ¡åŸŸ</h4>

<p>åˆ›å»ºå¯¹åº”çš„ä¸šåŠ¡åŸŸï¼Œéœ€è¦åˆ¶å®šä¸­æ–‡åˆ†æå™¨ï¼Œå…·ä½“åˆ›å»ºæ­¥éª¤å¦‚ä¸‹ï¼š</p>

<ol>
  <li>
    <p>æŠŠä¸­æ–‡åˆ†æå™¨çš„<code class="highlighter-rouge">IKAnalyzer2012FF_u1.jar</code>åŒ…æ·»åŠ åˆ° solr å·¥ç¨‹çš„libç›®å½•ä¸‹</p>

    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>rz /home/silhouette/apache-tomcat-8.5.38/webapps/solr/WEB-INF/lib
</code></pre></div>    </div>
  </li>
  <li>
    <p>æŠŠæ‰©å±•è¯å…¸ã€é…ç½®æ–‡ä»¶æ”¾åˆ° solr å·¥ç¨‹çš„ WEB-INF/classes ç›®å½•ä¸‹</p>

    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd</span> /home/silhouette/apache-tomcat-8.5.38/webapps/solr/WEB-INF/lib
<span class="nv">$ </span><span class="nb">mkdir </span>classes
<span class="nv">$ </span><span class="nb">cd </span>classes
<span class="nv">$ </span>rz ext_stopword.dic
<span class="nv">$ </span>rz IKAnalyzer.cfg.xml
<span class="nv">$ </span>rz mydict.dic
</code></pre></div>    </div>
  </li>
</ol>

<p>ä¸ºäº†è®©åˆ†è¯å™¨ç”Ÿæ•ˆï¼Œé…ç½®ä¸€ä¸ª FieldTypeï¼Œåˆ¶å®šä½¿ç”¨ IKAnalyzerçš„åˆ†è¯è§„åˆ™ï¼Œè¿™ä¸ªéœ€è¦ä¿®æ”¹<code class="highlighter-rouge">schema.xml</code>æ–‡ä»¶ï¼Œå…·ä½“ä¿®æ”¹æ­¥éª¤å¦‚ä¸‹ï¼š</p>

<ol>
  <li>
    <p>ä¿®æ”¹<code class="highlighter-rouge">schema.xml</code>æ–‡ä»¶</p>

    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd</span> /home/silhouette/solr-index/solr/collection1/conf
<span class="nv">$ </span>vim schema.xml
<span class="c"># ä¿®æ”¹ Solr çš„ schema.xml æ–‡ä»¶ï¼Œæ·»åŠ  FieldType</span>
<span class="c"># 1.æ·»åŠ IKåˆ†è¯å™¨çš„ç›¸å…³é…ç½®</span>
    &lt;<span class="o">!</span><span class="nt">--</span> IKAnalyzer--&gt;
    &lt;fieldType <span class="nv">name</span><span class="o">=</span><span class="s2">"text_ik"</span> <span class="nv">class</span><span class="o">=</span><span class="s2">"solr.TextField"</span><span class="o">&gt;</span>
      &lt;analyzer <span class="nv">class</span><span class="o">=</span><span class="s2">"org.wltea.analyzer.lucene.IKAnalyzer"</span>/&gt;
    &lt;/fieldType&gt;
<span class="c"># 2. é…ç½®ä¸šåŠ¡åŸŸï¼Œtypeåˆ¶å®šä½¿ç”¨è‡ªå®šä¹‰çš„ FieldType</span>
    &lt;field <span class="nv">name</span><span class="o">=</span><span class="s2">"item_title"</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"text_ik"</span> <span class="nv">indexed</span><span class="o">=</span><span class="s2">"true"</span> <span class="nv">stored</span><span class="o">=</span><span class="s2">"true"</span>/&gt;
    &lt;field <span class="nv">name</span><span class="o">=</span><span class="s2">"item_sell_point"</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"text_ik"</span> <span class="nv">indexed</span><span class="o">=</span><span class="s2">"true"</span> <span class="nv">stored</span><span class="o">=</span><span class="s2">"true"</span>/&gt;
    &lt;field <span class="nv">name</span><span class="o">=</span><span class="s2">"item_price"</span>  <span class="nb">type</span><span class="o">=</span><span class="s2">"long"</span> <span class="nv">indexed</span><span class="o">=</span><span class="s2">"true"</span> <span class="nv">stored</span><span class="o">=</span><span class="s2">"true"</span>/&gt;
    &lt;field <span class="nv">name</span><span class="o">=</span><span class="s2">"item_image"</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"string"</span> <span class="nv">indexed</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">stored</span><span class="o">=</span><span class="s2">"true"</span> /&gt;
    &lt;field <span class="nv">name</span><span class="o">=</span><span class="s2">"item_category_name"</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"string"</span> <span class="nv">indexed</span><span class="o">=</span><span class="s2">"true"</span> <span class="nv">stored</span><span class="o">=</span><span class="s2">"true"</span> /&gt;
   
    &lt;field <span class="nv">name</span><span class="o">=</span><span class="s2">"item_keywords"</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"text_ik"</span> <span class="nv">indexed</span><span class="o">=</span><span class="s2">"true"</span> <span class="nv">stored</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">multiValued</span><span class="o">=</span><span class="s2">"true"</span>/&gt;
    &lt;copyField <span class="nb">source</span><span class="o">=</span><span class="s2">"item_title"</span> <span class="nv">dest</span><span class="o">=</span><span class="s2">"item_keywords"</span>/&gt;
    &lt;copyField <span class="nb">source</span><span class="o">=</span><span class="s2">"item_sell_point"</span> <span class="nv">dest</span><span class="o">=</span><span class="s2">"item_keywords"</span>/&gt;
    &lt;copyField <span class="nb">source</span><span class="o">=</span><span class="s2">"item_category_name"</span> <span class="nv">dest</span><span class="o">=</span><span class="s2">"item_keywords"</span>/&gt;
</code></pre></div>    </div>
  </li>
</ol>

<p>é‡å¯tomcatï¼Œè®¿é—® solo æµ‹è¯•IKåˆ†è¯å™¨æ˜¯å¦ç”Ÿæ•ˆã€‚</p>

<h2 id="äºŒsolrjçš„ä½¿ç”¨">äºŒã€SolrJçš„ä½¿ç”¨</h2>

<h4 id="21-æ¦‚è¿°">2.1 æ¦‚è¿°</h4>

<p>SolrJ æ˜¯ Apache å®˜æ–¹æä¾›çš„ä¸€å¥— Java å¼€å‘çš„ï¼Œè®¿é—® Solr æœåŠ¡çš„ APIï¼Œé€šè¿‡è¿™å¥— API å¯ ä»¥è®©æˆ‘ä»¬çš„ç¨‹åºä¸ Solr æœåŠ¡äº§ç”Ÿäº¤äº’ï¼Œè®©æˆ‘ä»¬çš„ç¨‹åºå¯ä»¥å®ç°å¯¹ Solr ç´¢å¼•åº“çš„å¢åˆ æ”¹æŸ¥ã€‚</p>

<ul>
  <li>
    <p>æ·»åŠ ä¾èµ–ï¼š</p>

    <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependencies&gt;</span>
    <span class="c">&lt;!-- Junitå•å…ƒæµ‹è¯• --&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>junit<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>junit<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>4.12<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>org.apache.solr<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>solr-solrj<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>4.10.2<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="c">&lt;!-- Solråº•å±‚ä¼šä½¿ç”¨åˆ°slf4jæ—¥å¿—ç³»ç»Ÿ --&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>org.slf4j<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>slf4j-log4j12<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>1.7.22<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>commons-logging<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>commons-logging<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>1.2<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;/dependencies&gt;</span>
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="22-ä½¿ç”¨-solrj-æ·»åŠ æˆ–ä¿®æ”¹ç´¢å¼•åº“æ•°æ®">2.2 ä½¿ç”¨ SolrJ æ·»åŠ æˆ–ä¿®æ”¹ç´¢å¼•åº“æ•°æ®</h4>

<ol>
  <li>
    <p><code class="highlighter-rouge">åˆ›å»ºç´¢å¼•</code></p>

    <ol>
      <li>
        <p>ä»¥ Document å½¢å¼æ·»åŠ æˆ–ä¿®æ”¹æ•°æ®</p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">createIndex</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
  	<span class="c1">//å®šä¹‰Solrçš„URLè·¯å¾„</span>
    <span class="nc">String</span> <span class="n">baseURL</span> <span class="o">=</span> <span class="s">"http://192.168.0.111:8080/solr/collection1"</span><span class="o">;</span>
    <span class="c1">//è¦ä½¿ç”¨SolrJé¦–å…ˆåˆ›å»ºæœåŠ¡å¯¹è±¡ï¼ŒSolrå®é™…ä¸Šæ˜¯æä¾›webæœåŠ¡ï¼Œéœ€å•Šå“Ÿåˆ›å»ºwebæœåŠ¡çš„å¯¹è±¡ï¼Œæ”¯æŒHTTPè¯·æ±‚</span>
    <span class="nc">HttpSolrServer</span> <span class="n">server</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HttpSolrServer</span><span class="o">(</span><span class="n">baseURL</span><span class="o">);</span>
      
    <span class="c1">//æ·»åŠ ç´¢å¼•ï¼Œéœ€è¦Documentå¯¹è±¡</span>
    <span class="nc">SolrInputDocument</span> <span class="n">document</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SolrInputDocument</span><span class="o">();</span>
    <span class="n">document</span><span class="o">.</span><span class="na">addField</span><span class="o">(</span><span class="s">"id"</span><span class="o">,</span> <span class="s">"20"</span><span class="o">);</span>
    <span class="n">document</span><span class="o">.</span><span class="na">addField</span><span class="o">(</span><span class="s">"title"</span><span class="o">,</span> <span class="s">"ä»Šå¤©æ˜ŸæœŸäºŒï¼Œæ˜¯ä¸€å‘¨çš„ç¬¬ä¸‰å¤©ã€‚"</span><span class="o">);</span>
      
    <span class="c1">//å°†Documentæ·»åŠ åˆ°ç´¢å¼•åº“</span>
    <span class="n">server</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">document</span><span class="o">);</span>
      
    <span class="c1">//æäº¤è¯·æ±‚</span>
    <span class="n">server</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>        </div>
      </li>
      <li>
        <p>ä½¿ç”¨æ³¨è§£å’Œ JavaBean æ·»åŠ æˆ–ä¿®æ”¹æ•°æ®</p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testInsertIndexByBean</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="c1">//å®šä¹‰Solrçš„URLè·¯å¾„</span>
    <span class="nc">String</span> <span class="n">baseURL</span> <span class="o">=</span> <span class="s">"http://192.168.0.111:8080/solr/collection1"</span><span class="o">;</span>
    <span class="c1">//åˆ›å»ºJavaå¯¹è±¡</span>
    <span class="nc">Book</span> <span class="n">book</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Book</span><span class="o">(</span><span class="s">"12345"</span><span class="o">,</span> <span class="s">"Solråˆè¯†"</span><span class="o">,</span><span class="s">"silhouette"</span><span class="o">,</span><span class="s">"Solr æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ä¼ä¸šçº§æœç´¢åº”ç”¨æœåŠ¡å™¨"</span><span class="o">);</span>
    <span class="nc">HttpSolrServer</span> <span class="n">httpSolrServer</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HttpSolrServer</span><span class="o">(</span><span class="n">baseURL</span><span class="o">);</span>
      
    <span class="c1">//å°†å¯¹è±¡æ’å…¥ç´¢å¼•åº“</span>
    <span class="nc">UpdateResponse</span> <span class="n">updateResponse</span> <span class="o">=</span> <span class="n">httpSolrServer</span><span class="o">.</span><span class="na">addBean</span><span class="o">(</span><span class="n">book</span><span class="o">);</span>
    <span class="kt">int</span> <span class="n">status</span> <span class="o">=</span> <span class="n">updateResponse</span><span class="o">.</span><span class="na">getStatus</span><span class="o">();</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">status</span><span class="o">);</span>
    <span class="c1">//æäº¤</span>
    <span class="n">httpSolrServer</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>        </div>
      </li>
    </ol>
  </li>
  <li>
    <p><code class="highlighter-rouge">åˆ é™¤ç´¢å¼•</code></p>

    <ol>
      <li>
        <p>æ ¹æ® ID åˆ é™¤</p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testDleteIndexById</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
  	<span class="c1">//å®šä¹‰Solrçš„URLè·¯å¾„</span>
      <span class="nc">String</span> <span class="n">baseURL</span> <span class="o">=</span> <span class="s">"http://192.168.0.111:8080/solr/collection1"</span><span class="o">;</span>
      <span class="c1">//è¦ä½¿ç”¨SolrJé¦–å…ˆåˆ›å»ºæœåŠ¡å¯¹è±¡ï¼ŒSolrå®é™…ä¸Šæ˜¯æä¾›webæœåŠ¡ï¼Œéœ€å•Šå“Ÿåˆ›å»ºwebæœåŠ¡çš„å¯¹è±¡ï¼Œæ”¯æŒHTTPè¯·æ±‚</span>
      <span class="nc">HttpSolrServer</span> <span class="n">server</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HttpSolrServer</span><span class="o">(</span><span class="n">baseURL</span><span class="o">);</span>
      
  	<span class="c1">//server.deleteById("10");</span>
      <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;();</span>
      <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"10"</span><span class="o">);</span>
      <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"12"</span><span class="o">);</span>
      <span class="c1">//åˆ é™¤ç´¢å¼•</span>
      <span class="n">server</span><span class="o">.</span><span class="na">deleteById</span><span class="o">(</span><span class="n">list</span><span class="o">);</span>
      
      <span class="c1">//æäº¤è¯·æ±‚</span>
      <span class="n">server</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>        </div>
      </li>
      <li>
        <p>é€šè¿‡åˆ¶å®šæ¡ä»¶åˆ é™¤</p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testDleteIndexByQuery</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
  	<span class="c1">//å®šä¹‰Solrçš„URLè·¯å¾„</span>
    <span class="nc">String</span> <span class="n">baseURL</span> <span class="o">=</span> <span class="s">"http://192.168.0.111:8080/solr/collection1"</span><span class="o">;</span>
    <span class="c1">//è¦ä½¿ç”¨SolrJé¦–å…ˆåˆ›å»ºæœåŠ¡å¯¹è±¡ï¼ŒSolrå®é™…ä¸Šæ˜¯æä¾›webæœåŠ¡ï¼Œéœ€å•Šå“Ÿåˆ›å»ºwebæœåŠ¡çš„å¯¹è±¡ï¼Œæ”¯æŒHTTPè¯·æ±‚</span>
    <span class="nc">HttpSolrServer</span> <span class="n">server</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HttpSolrServer</span><span class="o">(</span><span class="n">baseURL</span><span class="o">);</span>
    <span class="c1">//Solræä¾›çš„æ˜¯webæœåŠ¡ï¼Œåœ¨æ¥æ”¶ç”¨æˆ·ä¼ é€’çš„å‚æ•°æ˜¯å°±æ˜¯requestå‚æ•°</span>
    <span class="nc">String</span> <span class="n">query</span><span class="o">=</span><span class="s">"title:solr"</span><span class="o">;</span>
      
    <span class="c1">//åˆ é™¤ç´¢å¼•</span>
    <span class="n">server</span><span class="o">.</span><span class="na">deleteByQuery</span><span class="o">(</span><span class="n">query</span><span class="o">);</span>
      
    <span class="c1">//æäº¤è¯·æ±‚</span>
    <span class="n">server</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>        </div>
      </li>
    </ol>
  </li>
  <li>
    <p><code class="highlighter-rouge">æŸ¥è¯¢ç´¢å¼•</code></p>

    <ol>
      <li>
        <p>ä»¥ Document å½¢å¼è¿”å›æŸ¥è¯¢ç»“æœ</p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testQueryIndex</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
  	<span class="c1">//å®šä¹‰Solrçš„URLè·¯å¾„</span>
    <span class="nc">String</span> <span class="n">baseURL</span> <span class="o">=</span> <span class="s">"http://192.168.0.111:8080/solr/collection1"</span><span class="o">;</span>
    <span class="c1">//è¦ä½¿ç”¨SolrJé¦–å…ˆåˆ›å»ºæœåŠ¡å¯¹è±¡ï¼ŒSolrå®é™…ä¸Šæ˜¯æä¾›webæœåŠ¡ï¼Œéœ€å•Šå“Ÿåˆ›å»ºwebæœåŠ¡çš„å¯¹è±¡ï¼Œæ”¯æŒHTTPè¯·æ±‚</span>
    <span class="nc">HttpSolrServer</span> <span class="n">server</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HttpSolrServer</span><span class="o">(</span><span class="n">baseURL</span><span class="o">);</span>
      
    <span class="nc">String</span> <span class="n">query</span> <span class="o">=</span> <span class="s">"*:*"</span><span class="o">;</span>
    <span class="c1">//è¿›è¡ŒæŸ¥è¯¢æ“ä½œ</span>
    <span class="nc">SolrParams</span> <span class="n">params</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SolrQuery</span><span class="o">(</span><span class="n">query</span> <span class="o">);</span>
    <span class="nc">QueryResponse</span> <span class="n">queryResponse</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="n">params</span><span class="o">);</span>
      
    <span class="nc">SolrDocumentList</span> <span class="n">results</span> <span class="o">=</span> <span class="n">queryResponse</span><span class="o">.</span><span class="na">getResults</span><span class="o">();</span>
      
    <span class="k">for</span> <span class="o">(</span><span class="nc">SolrDocument</span> <span class="n">solrDocument</span> <span class="o">:</span> <span class="n">results</span><span class="o">)</span> <span class="o">{</span>
      <span class="nc">String</span> <span class="n">id</span> <span class="o">=</span> <span class="o">(</span><span class="nc">String</span><span class="o">)</span> <span class="n">solrDocument</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"id"</span><span class="o">);</span>
      <span class="nc">String</span> <span class="n">name</span> <span class="o">=</span> <span class="o">(</span><span class="nc">String</span><span class="o">)</span> <span class="n">solrDocument</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"name"</span><span class="o">);</span>
      
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"id:"</span><span class="o">+</span><span class="n">id</span><span class="o">+</span><span class="s">" name:"</span><span class="o">+</span><span class="n">name</span><span class="o">);</span>
    <span class="o">}</span>
      
    <span class="c1">//æäº¤è¯·æ±‚</span>
    <span class="n">server</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>        </div>
      </li>
      <li>
        <p>ä»¥ JavaBean å½¢å¼è¿”å›æŸ¥è¯¢ç»“æœ</p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testQueryIndex</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
		<span class="c1">//å®šä¹‰Solrçš„URLè·¯å¾„</span>
      <span class="nc">String</span> <span class="n">baseURL</span> <span class="o">=</span> <span class="s">"http://192.168.0.111:8080/solr/collection1"</span><span class="o">;</span>
      <span class="c1">//è¦ä½¿ç”¨SolrJé¦–å…ˆåˆ›å»ºæœåŠ¡å¯¹è±¡ï¼ŒSolrå®é™…ä¸Šæ˜¯æä¾›webæœåŠ¡ï¼Œéœ€å•Šå“Ÿåˆ›å»ºwebæœåŠ¡çš„å¯¹è±¡ï¼Œæ”¯æŒHTTPè¯·æ±‚</span>
      <span class="nc">HttpSolrServer</span> <span class="n">server</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HttpSolrServer</span><span class="o">(</span><span class="n">baseURL</span><span class="o">);</span>
      
      <span class="nc">String</span> <span class="n">query</span> <span class="o">=</span> <span class="s">"author:silhouette"</span><span class="o">;</span>
      <span class="c1">//è¿›è¡ŒæŸ¥è¯¢æ“ä½œ</span>
      <span class="nc">SolrParams</span> <span class="n">params</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SolrQuery</span><span class="o">(</span><span class="n">query</span><span class="o">);</span>
      <span class="nc">QueryResponse</span> <span class="n">queryResponse</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="n">params</span><span class="o">);</span>
      
      <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Book</span><span class="o">&gt;</span> <span class="n">books</span> <span class="o">=</span> <span class="n">queryResponse</span><span class="o">.</span><span class="na">getBeans</span><span class="o">(</span><span class="nc">Book</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
      
      <span class="k">for</span> <span class="o">(</span><span class="nc">Book</span> <span class="n">book</span> <span class="o">:</span> <span class="n">books</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">book</span><span class="o">);</span>
      <span class="o">}</span>
      
      <span class="c1">//æäº¤è¯·æ±‚</span>
      <span class="n">server</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>        </div>

        <blockquote>
          <p>æ³¨æ„ï¼š1.JavaBeançš„å±æ€§è¦å’ŒSolrç•Œé¢ç®¡ç†å±•ç¤ºçš„å±æ€§è¦ä¸€è‡´ï¼Œå¦‚æœç¼ºå°‘å­—æ®µåˆ™è¡¥ä¸Šï¼Œå¦‚æœå±æ€§ä¸åŒï¼Œå°±ä¿®æ”¹JavaBeanæˆ–è€…scheme.xmlé…ç½®æ–‡ä»¶ã€‚</p>
        </blockquote>
      </li>
      <li>
        <p>SolrQuery å¯¹è±¡çš„é«˜çº§æŸ¥è¯¢</p>

        <ol>
          <li>
            <p>åŒ¹é…æ‰€æœ‰æ–‡æ¡£ï¼š*:* ï¼ˆé€šé…ç¬¦ï¼Ÿå’Œ*ï¼šâ€œ*â€è¡¨ç¤ºåŒ¹é…ä»»æ„å­—ç¬¦ï¼›â€œï¼Ÿâ€è¡¨ç¤ºåŒ¹é…å‡ºç°çš„ä½ç½®ï¼‰</p>
          </li>
          <li>
            <p>å¸ƒå°”æ“ä½œï¼šANDã€OR å’Œ NOT å¸ƒå°”æ“ä½œï¼ˆæ¨èä½¿ç”¨å¤§å†™ï¼ŒåŒºåˆ†æ™®é€šå­—æ®µï¼‰</p>
          </li>
          <li>
            <p>å­è¡¨è¾¾å¼æŸ¥è¯¢ï¼ˆå­æŸ¥è¯¢ï¼‰ï¼šå¯ä»¥ä½¿ç”¨â€œ()â€æ„é€ å­æŸ¥è¯¢ã€‚ æ¯”å¦‚ï¼š(query1 AND query2) OR(query3 AND query4)</p>
          </li>
          <li>
            <p>ç›¸ä¼¼åº¦æŸ¥è¯¢ï¼š</p>

            <ol>
              <li>é»˜è®¤ç›¸ä¼¼åº¦æŸ¥è¯¢ï¼štitle:appla~ ï¼Œæ­¤æ—¶é»˜è®¤ç¼–è¾‘è·ç¦»æ˜¯2ã€‚ï½è¡¨ç¤ºæ¨¡ç³ŠæŸ¥è¯¢ï¼Œé»˜è®¤ç¼–è¾‘è·ç¦»ä¸º2</li>
              <li>æŒ‡å®šç¼–è¾‘ä¸¾ä¾‹çš„ç›¸ä¼¼åº¦æŸ¥è¯¢ï¼šå¯¹æ¨¡ç³ŠæŸ¥è¯¢å¯ä»¥è®¾ç½®ç¼–è¾‘ä¸¾ä¾‹ï¼Œå¯é€‰ 0~2 çš„æ•´æ•°ã€‚</li>
            </ol>
          </li>
          <li>
            <p>èŒƒå›´æŸ¥è¯¢ï¼ˆRange Queryï¼‰ï¼šLucene æ”¯æŒå¯¹æ•°å­—ã€æ—¥æœŸç”šè‡³æ–‡æœ¬çš„èŒƒå›´æŸ¥è¯¢ã€‚ç»“æŸçš„èŒƒ å›´å¯ä»¥ä½¿ç”¨â€œ*â€é€šé…ç¬¦ã€‚</p>

            <ol>
              <li>æ—¥æœŸèŒƒå›´ï¼ˆISO-8601 æ—¶é—´ GMTï¼‰ï¼ša_begin_date:[1990-01-01T00:00:00.000Z TO 1999-12-31T24:59:99.999Z]</li>
              <li>æ•°å­—ï¼šsalary:[2000 TO *]</li>
              <li>æ–‡æœ¬ï¼šentryNm:[a TO a]</li>
            </ol>
          </li>
          <li>
            <p>æ—¥æœŸåŒ¹é…ï¼šYEAR, MONTH, DAY, DATE (synonymous with DAY) HOUR, MINUTE, SECOND, MILLISECOND, and MILLI (synonymous with MILLISECOND)å¯ä»¥è¢«æ ‡å¿—æˆ æ—¥æœŸã€‚</p>

            <ol>
              <li>r_event_date:[* TO NOW-2YEAR]ï¼š2 å¹´å‰çš„ç°åœ¨è¿™ä¸ªæ—¶é—´</li>
              <li>r_event_date:[* TO NOW/DAY-2YEAR]ï¼š2 å¹´å‰å‰ä¸€å¤©çš„è¿™ä¸ªæ—¶é—´</li>
            </ol>

            <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testQueryIndex</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
  	<span class="c1">//å®šä¹‰Solrçš„URLè·¯å¾„</span>
      <span class="nc">String</span> <span class="n">baseURL</span> <span class="o">=</span> <span class="s">"http://192.168.0.111:8080/solr/collection1"</span><span class="o">;</span>
      <span class="c1">//è¦ä½¿ç”¨SolrJé¦–å…ˆåˆ›å»ºæœåŠ¡å¯¹è±¡ï¼ŒSolrå®é™…ä¸Šæ˜¯æä¾›webæœåŠ¡ï¼Œéœ€å•Šå“Ÿåˆ›å»ºwebæœåŠ¡çš„å¯¹è±¡ï¼Œæ”¯æŒHTTPè¯·æ±‚</span>
      <span class="nc">HttpSolrServer</span> <span class="n">server</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HttpSolrServer</span><span class="o">(</span><span class="n">baseURL</span><span class="o">);</span>
           	
		<span class="nc">SolrParams</span> <span class="n">params</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SolrQuery</span><span class="o">(</span><span class="s">"description:æˆ˜å›½ AND id:3"</span><span class="o">);</span>
		<span class="nc">QueryResponse</span> <span class="n">queryResponse</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="n">params</span><span class="o">);</span>
         		
		<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Book</span><span class="o">&gt;</span> <span class="n">books</span> <span class="o">=</span> <span class="n">queryResponse</span><span class="o">.</span><span class="na">getBeans</span><span class="o">(</span><span class="nc">Book</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
         		
		<span class="k">for</span> <span class="o">(</span><span class="nc">Book</span> <span class="n">book</span> <span class="o">:</span> <span class="n">books</span><span class="o">)</span> <span class="o">{</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">book</span><span class="o">);</span>
		<span class="o">}</span>
         		
		<span class="c1">//æäº¤è¯·æ±‚</span>
		<span class="n">server</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>            </div>
          </li>
        </ol>
      </li>
    </ol>
  </li>
  <li>
    <p><code class="highlighter-rouge">æ’åºå®ç°</code></p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testQueryIndex</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
		<span class="c1">//å®šä¹‰Solrçš„URLè·¯å¾„</span>
      <span class="nc">String</span> <span class="n">baseURL</span> <span class="o">=</span> <span class="s">"http://192.168.0.111:8080/solr/collection1"</span><span class="o">;</span>
      <span class="c1">//è¦ä½¿ç”¨SolrJé¦–å…ˆåˆ›å»ºæœåŠ¡å¯¹è±¡ï¼ŒSolrå®é™…ä¸Šæ˜¯æä¾›webæœåŠ¡ï¼Œéœ€å•Šå“Ÿåˆ›å»ºwebæœåŠ¡çš„å¯¹è±¡ï¼Œæ”¯æŒHTTPè¯·æ±‚</span>
      <span class="nc">HttpSolrServer</span> <span class="n">server</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HttpSolrServer</span><span class="o">(</span><span class="n">baseURL</span><span class="o">);</span>
   
      <span class="nc">String</span> <span class="n">query</span> <span class="o">=</span> <span class="s">"author:*"</span><span class="o">;</span>
      <span class="c1">//è¿›è¡ŒæŸ¥è¯¢æ“ä½œ</span>
      <span class="nc">SolrParams</span> <span class="n">params</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SolrQuery</span><span class="o">(</span><span class="n">query</span><span class="o">);</span>
		<span class="n">params</span><span class="o">.</span><span class="na">addSort</span><span class="o">(</span><span class="s">"id"</span><span class="o">,</span> <span class="no">ORDER</span><span class="o">.</span><span class="na">asc</span><span class="o">);</span>
      <span class="nc">QueryResponse</span> <span class="n">queryResponse</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="n">params</span><span class="o">);</span>
   
      <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Book</span><span class="o">&gt;</span> <span class="n">books</span> <span class="o">=</span> <span class="n">queryResponse</span><span class="o">.</span><span class="na">getBeans</span><span class="o">(</span><span class="nc">Book</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
   
      <span class="k">for</span> <span class="o">(</span><span class="nc">Book</span> <span class="n">book</span> <span class="o">:</span> <span class="n">books</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">book</span><span class="o">);</span>
      <span class="o">}</span>
   
      <span class="c1">//æäº¤è¯·æ±‚</span>
      <span class="n">server</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><code class="highlighter-rouge">åˆ†é¡µå®ç°</code></p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testQueryIndex</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
		<span class="c1">//å®šä¹‰Solrçš„URLè·¯å¾„</span>
      <span class="nc">String</span> <span class="n">baseURL</span> <span class="o">=</span> <span class="s">"http://192.168.0.111:8080/solr/collection1"</span><span class="o">;</span>
      <span class="c1">//è¦ä½¿ç”¨SolrJé¦–å…ˆåˆ›å»ºæœåŠ¡å¯¹è±¡ï¼ŒSolrå®é™…ä¸Šæ˜¯æä¾›webæœåŠ¡ï¼Œéœ€å•Šå“Ÿåˆ›å»ºwebæœåŠ¡çš„å¯¹è±¡ï¼Œæ”¯æŒHTTPè¯·æ±‚</span>
      <span class="nc">HttpSolrServer</span> <span class="n">server</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HttpSolrServer</span><span class="o">(</span><span class="n">baseURL</span><span class="o">);</span>
   
      <span class="c1">//è¦æŸ¥è¯¢çš„é¡µæ•°</span>
      <span class="kt">int</span> <span class="n">pageNum</span> <span class="o">=</span> <span class="mi">2</span><span class="o">;</span>
      <span class="c1">//æ¯é¡µæ˜¾ç¤ºæ¡æ•°</span>
      <span class="kt">int</span> <span class="n">pageSize</span> <span class="o">=</span> <span class="mi">2</span><span class="o">;</span>
      <span class="c1">//å½“å‰é¡µçš„èµ·å§‹æ¡æ•°</span>
      <span class="kt">int</span> <span class="n">start</span> <span class="o">=</span> <span class="o">(</span><span class="n">pageNum</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span> <span class="o">*</span> <span class="n">pageSize</span><span class="o">;</span>
      <span class="c1">//å½“å‰é¡µçš„ç»“æŸæ¡æ•°</span>
      <span class="kt">int</span> <span class="n">end</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">pageSize</span><span class="o">;</span>
      <span class="nc">SolrQuery</span> <span class="n">query</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SolrQuery</span><span class="o">(</span><span class="s">"*:*"</span><span class="o">);</span>
   
      <span class="c1">//è®¾ç½®èµ·å§‹æ¡æ•°</span>
      <span class="n">query</span><span class="o">.</span><span class="na">setStart</span><span class="o">(</span><span class="n">start</span><span class="o">);</span>
      <span class="c1">//è®¾ç½®æ¯é¡µæ¡æ•°</span>
      <span class="n">query</span><span class="o">.</span><span class="na">setRows</span><span class="o">(</span><span class="n">pageSize</span><span class="o">);</span>
      <span class="c1">//è¿›è¡ŒæŸ¥è¯¢æ“ä½œ</span>
      <span class="nc">QueryResponse</span> <span class="n">queryResponse</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="n">query</span><span class="o">);</span>
      <span class="nc">SolrDocumentList</span> <span class="n">results</span> <span class="o">=</span> <span class="n">queryResponse</span><span class="o">.</span><span class="na">getResults</span><span class="o">();</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"å½“å‰ç¬¬"</span> <span class="o">+</span> <span class="n">pageNum</span> <span class="o">+</span> <span class="s">"é¡µï¼Œæœ¬é¡µå…±"</span> <span class="o">+</span><span class="n">results</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">+</span> <span class="s">"æ¡æ•°æ®ã€‚"</span><span class="o">);</span>
   
      <span class="k">for</span> <span class="o">(</span><span class="nc">SolrDocument</span> <span class="n">solrDocument</span> <span class="o">:</span> <span class="n">results</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">solrDocument</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"id"</span><span class="o">));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">solrDocument</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"title"</span><span class="o">));</span>
      <span class="o">}</span>
   
      <span class="c1">//æäº¤è¯·æ±‚</span>
      <span class="n">server</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><code class="highlighter-rouge">é«˜äº®å®ç°</code></p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testQueryIndex</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
		<span class="c1">//å®šä¹‰Solrçš„URLè·¯å¾„</span>
      <span class="nc">String</span> <span class="n">baseURL</span> <span class="o">=</span> <span class="s">"http://192.168.0.111:8080/solr/collection1"</span><span class="o">;</span>
      <span class="c1">//è¦ä½¿ç”¨SolrJé¦–å…ˆåˆ›å»ºæœåŠ¡å¯¹è±¡ï¼ŒSolrå®é™…ä¸Šæ˜¯æä¾›webæœåŠ¡ï¼Œéœ€å•Šå“Ÿåˆ›å»ºwebæœåŠ¡çš„å¯¹è±¡ï¼Œæ”¯æŒHTTPè¯·æ±‚</span>
      <span class="nc">HttpSolrServer</span> <span class="n">server</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HttpSolrServer</span><span class="o">(</span><span class="n">baseURL</span><span class="o">);</span>
      <span class="c1">//å®šä¹‰æŸ¥è¯¢æ¡ä»¶</span>
      <span class="nc">String</span> <span class="n">query</span> <span class="o">=</span> <span class="s">"title:*"</span><span class="o">;</span>
   
      <span class="c1">//è¿›è¡ŒæŸ¥è¯¢æ“ä½œ</span>
      <span class="nc">SolrQuery</span> <span class="n">params</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SolrQuery</span><span class="o">(</span><span class="n">query</span><span class="o">);</span>
   
      <span class="c1">//è®¾ç½®é«˜äº®</span>
      <span class="n">params</span><span class="o">.</span><span class="na">setHighlightSimplePre</span><span class="o">(</span><span class="s">"&lt;em&gt;"</span><span class="o">);</span>
      <span class="n">params</span><span class="o">.</span><span class="na">setHighlightSimplePost</span><span class="o">(</span><span class="s">"&lt;/em&gt;"</span><span class="o">);</span>
      <span class="c1">//è®¾ç½®é«˜äº®æ˜¾ç¤ºçš„å­—æ®µ</span>
      <span class="n">params</span><span class="o">.</span><span class="na">addHighlightField</span><span class="o">(</span><span class="s">"title"</span><span class="o">);</span>
   
      <span class="nc">QueryResponse</span> <span class="n">queryResponse</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="n">params</span><span class="o">);</span>
      <span class="nc">SolrDocumentList</span> <span class="n">results</span> <span class="o">=</span> <span class="n">queryResponse</span><span class="o">.</span><span class="na">getResults</span><span class="o">();</span>
   
      <span class="c1">//åœ¨mapä¸­é¦–å…ˆä½¿ç”¨æ¯ä¸€æ¡æ•°æ®çš„idä½œä¸ºé”®ï¼Œå°†æ•°æ®ä½œä¸ºå€¼ï¼ˆåªæœ‰é«˜äº®å­—æ®µï¼‰</span>
      <span class="c1">//Map&lt;String, List&lt;String&gt;&gt;å­˜æ”¾çš„æ˜¯ä¸€æ¡æ•°æ®çš„æ‰€æœ‰é«˜äº®å­—æ®µï¼Œé”®å°±æ˜¯å­—æ®µçš„åç§°ï¼Œå€¼å°±æ˜¯é«˜äº®æ˜¾ç¤ºçš„æ•°æ®</span>
      <span class="c1">//List&lt;String&gt;é‡Œé¢å°±æ˜¯ç»è¿‡å¤„ç†çš„é«˜äº®çš„å†…å®¹ï¼Œä¸»è¦æ˜¯å› ä¸ºSolrä¸­çš„å­—æ®µå¯ä»¥å­˜å‚¨å¤šä¸ªå€¼ï¼Œå¯¹äºå•ä¸ªæ•°æ®è€Œè¨€ï¼Œlistçš„é•¿åº¦éƒ½ä¸º1</span>
      <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;&gt;&gt;</span> <span class="n">highlighting</span> <span class="o">=</span> <span class="n">queryResponse</span><span class="o">.</span><span class="na">getHighlighting</span><span class="o">();</span>
   
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"æ‰¾åˆ°äº†"</span><span class="o">+</span><span class="n">results</span><span class="o">.</span><span class="na">size</span><span class="o">()+</span><span class="s">"æ¡è®°å½•"</span><span class="o">);</span>
   
      <span class="c1">//é‚£ä¹ˆè·å–é«˜äº®æ•°æ®å¯ä»¥è·å–å¯¹åº”çš„idï¼Œåœ¨æŒ‡å®šé«˜äº®å­—æ®µçš„åç§°ï¼Œåœ¨è·å–listçš„ç¬¬0ä¸ªå…ƒç´ </span>
      <span class="k">for</span> <span class="o">(</span><span class="nc">SolrDocument</span> <span class="n">solrDocument</span> <span class="o">:</span> <span class="n">results</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">id</span> <span class="o">=</span> <span class="n">solrDocument</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"id"</span><span class="o">).</span><span class="na">toString</span><span class="o">();</span>
        <span class="nc">String</span> <span class="n">title</span> <span class="o">=</span> <span class="n">highlighting</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">id</span><span class="o">).</span><span class="na">get</span><span class="o">(</span><span class="s">"title"</span><span class="o">).</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
   
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"id:"</span><span class="o">+</span><span class="n">id</span><span class="o">+</span><span class="s">"--- title:"</span><span class="o">+</span><span class="n">title</span><span class="o">);</span>
      <span class="o">}</span>
   
      <span class="c1">//æäº¤è¯·æ±‚</span>
      <span class="n">server</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><code class="highlighter-rouge">è®¾ç½®æƒé‡</code></p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testQueryIndex</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
		<span class="c1">//å®šä¹‰Solrçš„URLè·¯å¾„</span>
      <span class="nc">String</span> <span class="n">baseURL</span> <span class="o">=</span> <span class="s">"http://192.168.0.111:8080/solr/collection1"</span><span class="o">;</span>
      <span class="c1">//è¦ä½¿ç”¨SolrJé¦–å…ˆåˆ›å»ºæœåŠ¡å¯¹è±¡ï¼ŒSolrå®é™…ä¸Šæ˜¯æä¾›webæœåŠ¡ï¼Œéœ€å•Šå“Ÿåˆ›å»ºwebæœåŠ¡çš„å¯¹è±¡ï¼Œæ”¯æŒHTTPè¯·æ±‚</span>
      <span class="nc">HttpSolrServer</span> <span class="n">server</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HttpSolrServer</span><span class="o">(</span><span class="n">baseURL</span><span class="o">);</span>
   
      <span class="nc">SolrInputDocument</span> <span class="n">doc</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SolrInputDocument</span><span class="o">();</span>
   		
		<span class="c1">//é€šè¿‡boostè®¾ç½®å­—æ®µçš„æƒé‡</span>
		<span class="n">doc</span><span class="o">.</span><span class="na">addField</span><span class="o">(</span><span class="s">"id"</span><span class="o">,</span> <span class="s">"20"</span><span class="o">);</span>
		<span class="n">doc</span><span class="o">.</span><span class="na">addField</span><span class="o">(</span><span class="s">"description"</span><span class="o">,</span> <span class="s">"Springä»å…¥é—¨åˆ°ç²¾é€šæ˜¯ä¸€æœ¬å¥½ä¹¦"</span><span class="o">,</span><span class="mf">2.0f</span><span class="o">);</span>
		<span class="n">server</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">doc</span><span class="o">);</span>
   		
		<span class="c1">//æäº¤è¯·æ±‚</span>
		<span class="n">server</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
<span class="o">}</span>
   
<span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testCreateIndex</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
  	 <span class="c1">//å®šä¹‰Solrçš„URLè·¯å¾„</span>
		<span class="nc">String</span> <span class="n">baseURL</span> <span class="o">=</span> <span class="s">"http://192.168.0.111:8080/solr/collection1"</span><span class="o">;</span>
		<span class="c1">//è¦ä½¿ç”¨SolrJé¦–å…ˆåˆ›å»ºæœåŠ¡å¯¹è±¡ï¼ŒSolrå®é™…ä¸Šæ˜¯æä¾›webæœåŠ¡ï¼Œéœ€å•Šå“Ÿåˆ›å»ºwebæœåŠ¡çš„å¯¹è±¡ï¼Œæ”¯æŒHTTPè¯·æ±‚</span>
		<span class="nc">HttpSolrServer</span> <span class="n">server</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HttpSolrServer</span><span class="o">(</span><span class="n">baseURL</span><span class="o">);</span>
   		
		<span class="nc">SolrParams</span> <span class="n">params</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SolrQuery</span><span class="o">(</span><span class="s">"description:Spring"</span><span class="o">);</span>
		<span class="nc">QueryResponse</span> <span class="n">queryResponse</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="n">params</span><span class="o">);</span>
		<span class="nc">SolrDocumentList</span> <span class="n">results</span> <span class="o">=</span> <span class="n">queryResponse</span><span class="o">.</span><span class="na">getResults</span><span class="o">();</span>
   		
		<span class="k">for</span> <span class="o">(</span><span class="nc">SolrDocument</span> <span class="n">solrDocument</span> <span class="o">:</span> <span class="n">results</span><span class="o">)</span> <span class="o">{</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">solrDocument</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"id"</span><span class="o">)+</span><span class="s">" : "</span><span class="o">+</span><span class="n">solrDocument</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"description"</span><span class="o">));</span>
		<span class="o">}</span>
   		
		<span class="c1">//æäº¤è¯·æ±‚</span>
		<span class="n">server</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ol>

:ET