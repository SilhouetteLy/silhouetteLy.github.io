I"Ê<h2 id="ä¸€å…¨æ–‡æ£€ç´¢æŠ€æœ¯">ä¸€ã€<strong>å…¨æ–‡æ£€ç´¢æŠ€æœ¯</strong></h2>

<h4 id="11-æ•°æ®åˆ†ç±»">1.1 æ•°æ®åˆ†ç±»</h4>

<ul>
  <li>
    <p>æˆ‘ä»¬ç”Ÿæ´»ä¸­çš„æ•°æ®æ€»ä½“åˆ†ä¸ºä¸¤ç§ï¼š<strong>ç»“æ„åŒ–æ•°æ®</strong>å’Œ<strong>éç»“æ„åŒ–æ•°æ®</strong>ã€‚</p>

    <ul>
      <li>
        <p>ç»“æ„åŒ–æ•°æ®ï¼šæŒ‡å…·æœ‰å›ºå®šæ ¼å¼æˆ–æœ‰é™é•¿åº¦çš„æ•°æ®ï¼Œå¦‚æ•°æ®åº“ï¼Œå…ƒæ•°æ®ç­‰ã€‚</p>
      </li>
      <li>
        <p>éç»“æ„åŒ–æ•°æ®ï¼šæŒ‡ä¸å®šé•¿æˆ–æ— å›ºå®šæ ¼å¼çš„æ•°æ®ï¼Œå¦‚é‚®ä»¶ï¼Œwordæ–‡æ¡£ç­‰ç£ç›˜ä¸Šçš„æ–‡ä»¶</p>
      </li>
    </ul>
  </li>
</ul>

<h4 id="12-æ•°æ®çš„æŸ¥è¯¢">1.2 æ•°æ®çš„æŸ¥è¯¢</h4>

<ul>
  <li>
    <p>ç»“æ„åŒ–æ•°æ®çš„æŸ¥è¯¢</p>

    <ul>
      <li>SQLè¯­å¥ï¼ŒæŸ¥è¯¢ç»“æ„åŒ–æ•°æ®çš„æ–¹æ³•ã€‚ç®€å•ã€é€Ÿåº¦å¿«</li>
    </ul>
  </li>
  <li>
    <p>éç»“æ„åŒ–æ•°æ®çš„æŸ¥è¯¢</p>

    <ul>
      <li>é¡ºåºæ‰«ææ³•(Serial Scanning)
        <ul>
          <li>æ‰€è°“é¡ºåºæ‰«æï¼Œæ¯”å¦‚è¦æ‰¾å†…å®¹åŒ…å«æŸä¸€ä¸ªå­—ç¬¦ä¸²çš„æ–‡ä»¶ï¼Œå°±æ˜¯ä¸€ä¸ªæ–‡æ¡£ä¸€ä¸ªæ–‡æ¡£çš„çœ‹ï¼Œå¯¹ä¸æ¯ä¸€ä¸ªæ–‡æ¡£ï¼Œä»å¤´çœ‹åˆ°å°¾ï¼Œå¦‚æœæ­¤æ–‡æ¡£åŒ…å«æ­¤å­—ç¬¦ä¸²ï¼Œåˆ™æ­¤æ–‡æ¡£ä¸ºæˆ‘ä»¬è¦æ‰¾çš„æ–‡ä»¶ï¼Œæ¥ç€çœ‹ä¸‹ä¸€ä¸ªæ–‡ä»¶ï¼ŒçŸ¥é“æ‰«æ‰«æå®Œæ‰€æœ‰çš„æ–‡ä»¶ã€‚å¦‚åˆ©ç”¨ windows çš„æœç´¢ä¹Ÿå¯ä»¥æœç´¢æ–‡ä»¶å†…å®¹ï¼Œåªæ˜¯ç›¸å½“çš„æ…¢ã€‚</li>
        </ul>
      </li>
      <li>å…¨æ–‡æ£€ç´¢(Full-text Search)
        <ul>
          <li>å°†éç»“æ„åŒ–æ•°æ®ä¸­çš„ä¸€éƒ¨åˆ†æå–å‡ºæ¥ï¼Œé‡æ–°ç»„ç»‡ï¼Œä½¿å…¶å˜å¾—æœ‰ä¸€å®šç»“æ„ï¼Œç„¶åå¯¹æ­¤æœ‰ä¸€å®šç»“æ„çš„æ•°æ®è¿›è¡Œæœç´¢ï¼Œä»è€Œè¾¾åˆ°æœç´¢ç›¸å¯¹è¾ƒå¿«çš„ç›®çš„ã€‚è¿™éƒ¨åˆ†ä»éç»“æ„åŒ–æ•°æ®ä¸­æå–å‡ºçš„ç„¶åé‡æ–°ç»„ç»‡çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬ç§°ä¹‹<code class="highlighter-rouge">ç´¢å¼•</code>ã€‚</li>
          <li><strong>è¿™ç§å…ˆå»ºç«‹ç´¢å¼•ï¼Œå†å¯¹ç´¢å¼•è¿›è¡Œæœç´¢çš„è¿‡ç¨‹ç§°ä¹‹ä¸ºå…¨æ–‡æ£€ç´¢(Full-text Search)</strong></li>
          <li>è™½ç„¶åˆ›å»ºç´¢å¼•çš„è¿‡ç¨‹ä¹Ÿæ˜¯æ¯”è¾ƒè€—æ—¶çš„ï¼Œä½†æ˜¯ç´¢å¼•ä¸€å•åˆ›å»ºå°±å¯ä»¥å¤šæ¬¡ä½¿ç”¨ï¼Œå…¨æ–‡æ£€ç´¢ä¸»è¦å¤„ç†çš„æ˜¯æŸ¥è¯¢ï¼Œæ‰€ä»¥è€—æ—¶é—´åˆ›å»ºç´¢å¼•æ˜¯å€¼å¾—çš„ã€‚</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
    <p>æœç´¢å¼•æ“çš„åŸç†</p>

    <p><img src="/Users/silhouette/note/å…¨æ–‡æ£€ç´¢æŠ€æœ¯/Lucene/images/00-æœç´¢å¼•æ“çš„åŸç†.png" alt="00-æœç´¢å¼•æ“çš„åŸç†" style="zoom:50%;" /></p>
  </li>
</ul>

<h4 id="13-å…¨æ–‡æ£€ç´¢çš„å®ç°å’Œåº”ç”¨å¸¸è§">1.3 å…¨æ–‡æ£€ç´¢çš„å®ç°å’Œåº”ç”¨å¸¸è§</h4>

<ul>
  <li>å®ç°
    <ul>
      <li>å¯ä»¥ä½¿ç”¨ <code class="highlighter-rouge">Lucene</code> å®ç°å…¨æ–‡æ£€ç´¢ã€‚<code class="highlighter-rouge">Lucene æ˜¯Apache ä¸‹çš„ä¸€ä¸ªå¼€æ”¾æºç çš„å…¨æ–‡å¼•æ“å·¥å…·åŒ…</code>ã€‚æä¾›äº†å®Œæ•´çš„æŸ¥è¯¢å¼•æ“å’Œç´¢å¼•å¼•æ“ï¼Œéƒ¨åˆ†æ–‡æœ¬åˆ†æå¼•æ“ã€‚Lucene çš„ç›®çš„æ˜¯ä¸ºè½¯ä»¶å¼€å‘äººå‘˜æä¾›ä¸€ä¸ªç®€å•æ˜“ç”¨çš„å·¥å…·åŒ…ï¼Œä»¥ä¾¿åœ¨ç›®æ ‡ç³»ç»Ÿä¸­å®ç°å…¨æ–‡æ£€ç´¢çš„åŠŸèƒ½ã€‚</li>
      <li><code class="highlighter-rouge">Lucene æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½ã€å¯ä¼¸ç¼©çš„ä¿¡æ¯æœç´¢(IR)åº“</code>ã€‚å®ƒå¯ä»¥ä¸ºä½ çš„åº”ç”¨ç¨‹åºæ·»åŠ ç´¢å¼•å’Œ æœç´¢èƒ½åŠ›ã€‚<strong>Lucene æ˜¯ç”¨ java å®ç°çš„</strong>ã€æˆç†Ÿçš„å¼€æºé¡¹ç›®ï¼Œæ˜¯è‘—åçš„ Apache Jakarta å¤§å®¶åº­ çš„ä¸€å‘˜ï¼Œå¹¶ä¸”åŸºäº Apache è½¯ä»¶è®¸å¯ [ASF, License]ã€‚åŒæ ·ï¼ŒLucene æ˜¯å½“å‰éå¸¸æµè¡Œçš„ã€ å…è´¹çš„ Java ä¿¡æ¯æœç´¢(IR)åº“ã€‚</li>
    </ul>
  </li>
  <li>åº”ç”¨åœºæ™¯
    <ul>
      <li>æœç´¢å¼•æ“ï¼šç™¾åº¦ã€360æ£€ç´¢ã€Googleç­‰æœç´¢å¼•æ“</li>
      <li>ç«™å†…æœç´¢ï¼šè®ºå›æœç´¢ã€å¾®åšã€æ–‡ç« æœç´¢</li>
      <li>ç”µå•†æœç´¢ï¼šæ·˜å®æœç´¢ã€äº¬ä¸œæœç´¢</li>
      <li>åªè¦æ˜¯æœ‰æœç´¢çš„åœ°æ–¹å°±å¯ä»¥ä½¿ç”¨å…¨æ–‡æ£€ç´¢æŠ€æœ¯ã€‚</li>
    </ul>
  </li>
  <li>Lucene ä¸ Solr çš„å…³ç³»
    <ul>
      <li>Lucene æ˜¯ä¸€å¥—å®ç°äº†å…¨æ–‡æ£€ç´¢çš„åº•å±‚ APIï¼Œæä¾›å¯¹äºå…¨æ–‡æ£€ç´¢çš„åŸºç¡€æ”¯æŒï¼Œè€Œ Solr æ˜¯ å…¨æ–‡æ£€ç´¢å¼•æ“çš„ä¸€ä¸ªå®ç°äº§å“ï¼Œæ˜¯ä¸€ä¸ªä¼ä¸šçº§æœç´¢åº”ç”¨æœåŠ¡å™¨ã€‚</li>
    </ul>
  </li>
</ul>

<h2 id="äºŒlucene-å®ç°å…¨æ–‡æ£€ç´¢çš„æµç¨‹">äºŒã€Lucene å®ç°å…¨æ–‡æ£€ç´¢çš„æµç¨‹</h2>

<h4 id="21-ç´¢å¼•å’Œæœç´¢æµç¨‹å›¾">2.1 ç´¢å¼•å’Œæœç´¢æµç¨‹å›¾</h4>

<p><img src="/Users/silhouette/note/å…¨æ–‡æ£€ç´¢æŠ€æœ¯/Lucene/images/01-ç´¢å¼•å’Œæœç´¢æµç¨‹å›¾.png" alt="01-ç´¢å¼•å’Œæœç´¢æµç¨‹å›¾" style="zoom:50%;" /></p>

<ul>
  <li>ç»¿è‰²è¡¨ç¤ºåˆ›å»ºç´¢å¼•è¿‡ç¨‹ï¼Œå¯¹è¦æœç´¢çš„åŸå§‹å†…å®¹è¿›è¡Œç´¢å¼•æ„å»ºä¸€ä¸ªç´¢å¼•åº“ï¼Œç´¢å¼•åˆ›å»ºè¿‡ç¨‹åŒ…æ‹¬ï¼šç¡®è®¤åŸå§‹å†…å®¹å³æœç´¢çš„å†…å®¹â€“&gt;é‡‡é›†æ–‡æ¡£â€“&gt;åˆ›å»ºæ–‡æ¡£â€“&gt;åˆ†ææ–‡æ¡£â€“&gt;ç´¢å¼•æ–‡æ¡£</li>
  <li>çº¢è‰²è¡¨ç¤ºæœç´¢è¿‡ç¨‹ï¼Œä»ç´¢å¼•åº“ä¸­æœç´¢å†…å®¹ï¼Œæœç´¢è¿‡ç¨‹åŒ…æ‹¬ï¼šç”¨æˆ·é€šè¿‡æœç´¢ç•Œé¢â€“&gt;åˆ›å»ºæŸ¥è¯¢â€“&gt;æ‰§è¡Œæœç´¢ï¼Œä»ç´¢å¼•åº“æœç´¢â€“&gt;æ¸²æŸ“æœç´¢ç»“æœ</li>
</ul>

<h4 id="22-åˆ›å»ºç´¢å¼•">2.2 åˆ›å»ºç´¢å¼•</h4>

<ol>
  <li>è·å–æ–‡æ¡£
    <ul>
      <li>åŸå§‹æ–‡æ¡£ï¼šè¦åŸºäºé‚£äº›æ•°æ®æ¥è¿›è¡Œæœç´¢ï¼Œé‚£ä¹ˆè¿™äº›æ•°æ®å°±æ˜¯åŸå§‹æ–‡æ¡£ã€‚</li>
      <li>æœç´¢å¼•æ“ï¼šä½¿ç”¨çˆ¬è™«æŠ€æœ¯è·å–åŸå§‹æ–‡æ¡£</li>
      <li>ç«™å†…æœç´¢ï¼šæ•°æ®åº“ä¸­çš„æ•°æ®</li>
    </ul>
  </li>
  <li>æ„å»ºæ–‡æ¡£å¯¹è±¡
    <ul>
      <li>å¯¹é¥®æ¯ä¸ªåŸå§‹æ–‡æ¡£åˆ›å»ºä¸€ä¸ª Document å¯¹è±¡ï¼Œæ¯ä¸€ä¸ªæ–‡æ¡£éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ç¼–å·ï¼Œå°±æ˜¯æ–‡æ¡£ID</li>
      <li>æ¯ä¸ªDocumentå¯ä»¥æœ‰å¤šä¸ªField(åŸŸ)ï¼ŒåŸŸä¸­ä¿å­˜çš„å°±æ˜¯åŸå§‹æ•°æ®ã€‚ä¸åŒçš„Documentå¯ä»¥æœ‰ä¸åŒçš„Fieldï¼ŒåŒä¸€ä¸ªDocumentå¯ä»¥æœ‰ç›¸åŒçš„Fieldã€‚</li>
      <li>åŸŸå¯¹è±¡åŒ…å«åŸŸçš„åç§°(Name)å’ŒåŸŸçš„å€¼(value)</li>
    </ul>
  </li>
  <li>åˆ†ææ–‡æ¡£
    <ul>
      <li>å°†åŸå§‹å†…å®¹ç©¿ä»¶ä¸ºåŒ…å«åŸŸ(Field)çš„æ–‡æ¡£(Document)ï¼Œéœ€è¦å†å¯¹åŸŸä¸­çš„å†…å®¹è¿›è¡Œåˆ†æï¼Œåˆ†æçš„è¿‡ç¨‹æ˜¯ç»è¿‡æ„¿æ„æ–‡æ¡£æå–å•è¯ã€å°†å­—æ¯è½¬ä¸ºå°è°¢ã€å»é™¤æ ‡ç‚¹ç¬¦å·ã€å»é™¤åœç”¨è¯ç­‰è¿‡ç¨‹ç”Ÿæˆæœ€ç»ˆçš„è¯­æ±‡æ·¡äº‘ï¼Œå¯ä»¥å°†è¯­æ±‡å•å…ƒç†è§£ä¸ºä¸€ä¸ªä¸€ä¸ªçš„å•è¯(ç®¡å®¶è¯)ã€‚</li>
      <li>æ¯ä¸ªå•è¯å«åšä¸€ä¸ªTermï¼Œä¸åŒçš„åŸŸä¸­æ‹†åˆ†å‡ºæ¥çš„ç›¸åŒå•è¯æ˜¯ä¸åŒçš„termã€‚termä¸­åŒ…å«ä¸¤éƒ¨åˆ†ï¼šä¸€éƒ¨åˆ†æ˜¯æ–‡æ¡£çš„åŸŸåï¼Œå¦ä¸€ä¸ªæ˜¯å•è¯çš„å†…å®¹ã€‚</li>
    </ul>
  </li>
  <li>åˆ›å»ºç´¢å¼•
    <ul>
      <li>å¯¹æ‰€æœ‰æ–‡æ¡£åˆ†æå¾—å‡ºçš„è¯­æ±‡å•å…ƒè¿›è¡Œç´¢å¼•ï¼Œç´¢å¼•çš„ç›®çš„æ˜¯ä¸ºäº†æœç´¢ï¼Œå’ä¸­è¦å®ç°åªæœç´¢è¢«ç´¢å¼•çš„è¯­æ±‡å•å…ƒä»è€Œæ‰¾åˆ°Document(æ–‡æ¡£)ã€‚</li>
      <li>åˆ›å»ºç´¢å¼•æ˜¯å¯¹è¯­æ±‡å•å…ƒç´¢å¼•ï¼Œé€šè¿‡è¯è¯­ç€æ–‡æ¡£ï¼Œè¿™ç§ç´¢å¼•çš„ç»“æ„å«<strong>å€’æ’ç´¢å¼•ç»“æ„</strong></li>
      <li><strong>å€’æ’ç´¢å¼•ç»“æ„ä¹Ÿå«åå‘ç´¢å¼•ç»“æ„ï¼ŒåŒ…æ‹¬ç´¢å¼•å’Œæ–‡æ¡£ä¸¤éƒ¨åˆ†ï¼Œç´¢å¼•å³è¯æ±‡è¡¨ï¼Œå®ƒçš„è§„æ¨¡è¾ƒå°ï¼Œè€Œæ–‡æ¡£é›†åˆè¾ƒå¤§ã€‚</strong></li>
    </ul>
  </li>
</ol>

<h4 id="23-æŸ¥è¯¢ç´¢å¼•">2.3 æŸ¥è¯¢ç´¢å¼•</h4>

<ol>
  <li>ç”¨æˆ·æ’å™æ¥å£
    <ul>
      <li>å…¨æ–‡æ£€ç´¢ç³»ç»Ÿæä¾›ç”¨æˆ·æœç´¢çš„ç•Œé¢ä¾›ç”¨æˆ·æäº¤æœç´¢çš„å…³é”®è¯ï¼Œæœç´¢å®Œæˆå±•ç¤ºæœç´¢ç»“æœã€‚</li>
    </ul>
  </li>
  <li>åˆ›å»ºæŸ¥è¯¢
    <ul>
      <li>ç”¨æˆ·è¾“å…¥æŸ¥è¯¢å…³é”®å­—æ‰§è¡Œæœç´¢ä¹‹å‰éœ€è¦è§æ„å»ºä¸€ä¸ªæŸ¥è¯¢å¯¹è±¡ï¼ŒæŸ¥è¯¢å¯¹è±¡ä¸­å¯ä»¥æŒ‡å®šæŸ¥è¯¢è¦æœç´¢çš„ Field æ–‡æ¡£åŸŸã€æŸ¥è¯¢å…³é”®å­—ç­‰ï¼ŒæŸ¥è¯¢å¯¹è±¡ä¼šç”Ÿæˆå…·ä½“çš„æŸ¥è¯¢è¯­æ³•ã€‚</li>
    </ul>
  </li>
  <li>æ‰§è¡ŒæŸ¥è¯¢
    <ul>
      <li>æ ¹æ®æŸ¥è¯¢è¯­æ³•åœ¨å€’æ’ç´¢å¼•è¯å…¸è¡¨ä¸­æ‰¾å‡ºå¯¹åº”æœç´¢è¯çš„ç´¢å¼•ï¼Œä»è€Œæ‰¾åˆ°ç´¢å¼•æ‰€é“¾æ¥çš„æ–‡æ¡£é“¾è¡¨ã€‚</li>
    </ul>
  </li>
  <li>æ¸²æŸ“ç»“æœ
    <ul>
      <li>ä»¥ä¸€ä¸ªå‹å¥½çš„ç•Œé¢å°†æŸ¥è¯¢ç»“æœå±•ç¤ºç»™ç”¨æˆ·ï¼Œç”¨æˆ·æ ¹æ®æœç´¢ç»“æœæ‰¾åˆ°è‡ªå·±æƒ³è¦çš„ä¿¡æ¯ï¼Œä¸ºäº†å¸®åŠ©ç”¨æˆ·å¾ˆå¿«æ‰¾åˆ°è‡ªå·±çš„ç»“æœï¼Œæä¾›äº†å¾ˆå¤šå±•ç¤ºçš„æ•ˆæœï¼Œæ¯”å¦‚æœç´¢ç»“æœä¸­å°†å…³é”®å­—é«˜äº®æ˜¾ç¤ºï¼Œç™¾åº¦æä¾›çš„å¿«ç…§ç­‰ã€‚</li>
    </ul>
  </li>
</ol>

<h2 id="ä¸‰luceneçš„ä½¿ç”¨">ä¸‰ã€Luceneçš„ä½¿ç”¨</h2>

<h4 id="31-é…ç½®å¼€å‘ç¯å¢ƒ">3.1 é…ç½®å¼€å‘ç¯å¢ƒ</h4>

<ul>
  <li>
    <p>Luceneä¸‹è½½</p>

    <ul>
      <li>Luceneæ˜¯å¼€å‘å…¨æ–‡æ£€ç´¢åŠŸèƒ½çš„å·¥å…·åŒ…ï¼Œä»<a href="http://lucene.apache.org/">å®˜æ–¹ç½‘ç«™</a>ä¸‹è½½å‹ç¼©åŒ…ï¼Œå¹¶è§£å‹ã€‚</li>
      <li>æ­¤å¤„ä¸‹è½½çš„ç‰ˆæœ¬æ˜¯lucene-7.4.0ï¼ŒJDKè¦æ±‚1.8ä»¥ä¸Šã€‚</li>
    </ul>
  </li>
  <li>
    <p>ä½¿ç”¨çš„jaråŒ…</p>

    <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependencies&gt;</span>
        <span class="c">&lt;!-- https://mvnrepository.com/artifact/org.apache.lucene/lucene-core --&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.apache.lucene<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>lucene-core<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>7.4.0<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.apache.lucene<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>lucene-analyzers-common<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>7.4.0<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>commons-io<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>commons-io<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>2.2<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
  			<span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>junit<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>junit<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>4.12<span class="nt">&lt;/version&gt;</span>
            <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;/dependencies&gt;</span>
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="32-åˆ›å»ºç´¢å¼•">3.2 åˆ›å»ºç´¢å¼•</h4>

<ol>
  <li>
    <p>å®ç°æ­¥éª¤</p>

    <ol>
      <li>åˆ›å»ºä¸€ä¸ª Director å¯¹è±¡ï¼ŒæŒ‡å®šç´¢å¼•åº“ä¿å­˜çš„ä½ç½®</li>
      <li>åŸºäºDirectoryå¯¹è±¡åˆ›å»ºä¸€ä¸ªIndexWriterå¯¹è±¡</li>
      <li>è¯»å–ç£ç›˜ä¸Šçš„æ–‡ä»¶ï¼Œå¯¹åº”æ¯ä¸ªæ–‡ä»¶åˆ›å»ºä¸€ä¸ªæ–‡æ¡£å¯¹è±¡</li>
      <li>å‘æ–‡æ¡£å¯¹è±¡ä¸­æ·»åŠ åŸŸ</li>
      <li>æŠŠæ–‡æ¡£å¯¹è±¡å†™å…¥ç´¢å¼•åº“ä¸­</li>
      <li>å…³é—­indexWriterå¯¹è±¡</li>
    </ol>
  </li>
  <li>
    <p>ä»£ç å®ç°</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">createIndex</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
    <span class="c1">// 1. åˆ›å»ºä¸€ä¸ª Director å¯¹è±¡ï¼ŒæŒ‡å®šç´¢å¼•åº“ä¿å­˜çš„ä½ç½®,å¯ä»¥æ˜¯ç£ç›˜ï¼Œä¹Ÿå¯ä»¥æ˜¯å†…å­˜</span>
    <span class="c1">//Directory directory = new RAMDirectory();//ä¿å­˜åˆ°å†…å­˜ä¸­ï¼ˆè™½ç„¶é€Ÿåº¦å¿«ï¼Œä½†æ˜¯å å†…å­˜ï¼Œç”¨çš„æ¯”è¾ƒå°‘ï¼‰</span>
    <span class="c1">//Directory directory = FSDirectory.open(new File("D:\\temp\\index").toPath());</span>
    <span class="nc">Directory</span> <span class="n">directory</span> <span class="o">=</span> 
      			<span class="nc">FSDirectory</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"/Users/silhouette/Downloads/temp"</span><span class="o">).</span><span class="na">toPath</span><span class="o">());</span>
    <span class="c1">//2. åŸºäºDirectoryå¯¹è±¡åˆ›å»ºä¸€ä¸ªIndexWriterå¯¹è±¡</span>
    <span class="nc">IndexWriterConfig</span> <span class="n">config</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IndexWriterConfig</span><span class="o">();</span>
    <span class="nc">IndexWriter</span> <span class="n">indexWriter</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IndexWriter</span><span class="o">(</span><span class="n">directory</span><span class="o">,</span><span class="n">config</span><span class="o">);</span>
    <span class="c1">//3. è¯»å–ç£ç›˜ä¸Šçš„æ–‡ä»¶ï¼Œå¯¹åº”æ¯ä¸ªæ–‡ä»¶åˆ›å»ºä¸€ä¸ªæ–‡æ¡£å¯¹è±¡</span>
    <span class="c1">//File dir = new File("D:\\temp\\searchsource");//åŸå§‹æ–‡æ¡£çš„è·¯å¾„</span>
     <span class="nc">File</span> <span class="n">dir</span> <span class="o">=</span> <span class="k">new</span> 
       		<span class="nc">File</span><span class="o">(</span><span class="s">"/Users/silhouette/code/my-project/springsecurity/src/main/resources"</span><span class="o">);</span>
     <span class="nc">File</span><span class="o">[]</span> <span class="n">files</span> <span class="o">=</span> <span class="n">dir</span><span class="o">.</span><span class="na">listFiles</span><span class="o">();</span>
     <span class="k">for</span> <span class="o">(</span><span class="nc">File</span> <span class="n">file</span> <span class="o">:</span> <span class="n">files</span><span class="o">){</span>
         <span class="nc">String</span> <span class="n">fileName</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="na">getName</span><span class="o">();</span> <span class="c1">//æ–‡ä»¶å</span>
         <span class="nc">String</span> <span class="n">fileContent</span> <span class="o">=</span> <span class="nc">FileUtils</span><span class="o">.</span><span class="na">readFileToString</span><span class="o">(</span><span class="n">file</span><span class="o">);</span><span class="c1">//æ–‡ä»¶å†…å®¹</span>
         <span class="nc">String</span> <span class="n">filePath</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="na">getPath</span><span class="o">();</span><span class="c1">//æ–‡ä»¶è·¯å¾„</span>
         <span class="kt">long</span> <span class="n">fileSize</span> <span class="o">=</span> <span class="nc">FileUtils</span><span class="o">.</span><span class="na">sizeOf</span><span class="o">(</span><span class="n">file</span><span class="o">);</span><span class="c1">//æ–‡ä»¶çš„å¤§å°</span>
         <span class="c1">//åˆ›å»ºæ–‡ä»¶ååŸŸField ï¼ˆåŸŸçš„åç§°ã€åŸŸçš„å†…å®¹ã€æ˜¯å¦å­˜å‚¨ï¼‰</span>
         <span class="nc">Field</span> <span class="n">fileNameField</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TextField</span><span class="o">(</span><span class="s">"fileName"</span><span class="o">,</span><span class="n">fileName</span><span class="o">,</span><span class="nc">Field</span><span class="o">.</span><span class="na">Store</span><span class="o">.</span><span class="na">YES</span><span class="o">);</span>
         <span class="nc">Field</span> <span class="n">fileContentField</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TextField</span><span class="o">(</span><span class="s">"fileContent"</span><span class="o">,</span><span class="n">fileContent</span><span class="o">,</span><span class="nc">Field</span><span class="o">.</span><span class="na">Store</span><span class="o">.</span><span class="na">YES</span><span class="o">);</span>
         <span class="nc">Field</span> <span class="n">filePathField</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TextField</span><span class="o">(</span><span class="s">"filePath"</span><span class="o">,</span><span class="n">filePath</span><span class="o">,</span><span class="nc">Field</span><span class="o">.</span><span class="na">Store</span><span class="o">.</span><span class="na">YES</span><span class="o">);</span>
         <span class="nc">Field</span> <span class="n">fileSizeField</span> <span class="o">=</span> <span class="k">new</span> 
           					<span class="nc">TextField</span><span class="o">(</span><span class="s">"fileSize"</span><span class="o">,</span><span class="nc">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">fileSize</span><span class="o">),</span><span class="nc">Field</span><span class="o">.</span><span class="na">Store</span><span class="o">.</span><span class="na">YES</span><span class="o">);</span>
         <span class="c1">//4.åˆ›å»ºdocumentå¯¹è±¡</span>
         <span class="nc">Document</span> <span class="n">document</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Document</span><span class="o">();</span>
         <span class="n">document</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">fileNameField</span><span class="o">);</span>
         <span class="n">document</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">fileContentField</span><span class="o">);</span>
         <span class="n">document</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">filePathField</span><span class="o">);</span>
         <span class="n">document</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">fileSizeField</span><span class="o">);</span>
         <span class="c1">//5.åˆ›å»ºç´¢å¼•ï¼Œå¹¶å†™å…¥ç´¢å¼•åº“</span>
         <span class="n">indexWriter</span><span class="o">.</span><span class="na">addDocument</span><span class="o">(</span><span class="n">document</span><span class="o">);</span>
     <span class="o">}</span>
    <span class="c1">//6. å…³é—­indexWriterå¯¹è±¡</span>
    <span class="n">indexWriter</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>ä½¿ç”¨ Luke å·¥å…·æŸ¥çœ‹ç´¢å¼•æ–‡ä»¶</p>

    <p><img src="/Users/silhouette/note/å…¨æ–‡æ£€ç´¢æŠ€æœ¯/Lucene/images/02-ä½¿ç”¨ Luke å·¥å…·æŸ¥çœ‹ç´¢å¼•æ–‡ä»¶.png" alt="02-ä½¿ç”¨ Luke å·¥å…·æŸ¥çœ‹ç´¢å¼•æ–‡ä»¶" style="zoom:50%;" /></p>

    <p>æˆ‘ä»¬ä½¿ç”¨çš„lukeçš„ç‰ˆæœ¬æ˜¯luke-7.4.0ï¼Œè·Ÿluceneçš„ç‰ˆæœ¬å¯¹åº”çš„ã€‚å¯ä»¥æ‰“å¼€7.4.0ç‰ˆæœ¬çš„luceneåˆ›å»ºçš„ç´¢å¼•åº“ã€‚éœ€è¦æ³¨æ„çš„æ˜¯æ­¤ç‰ˆæœ¬çš„Lukeæ˜¯jdk9ç¼–è¯‘çš„ï¼Œæ‰€ä»¥è¦æƒ³è¿è¡Œæ­¤å·¥å…·è¿˜éœ€è¦jdk9æ‰å¯ä»¥ã€‚</p>
  </li>
</ol>

<h4 id="33-æŸ¥è¯¢ç´¢å¼•">3.3 æŸ¥è¯¢ç´¢å¼•</h4>

<ol>
  <li>
    <p>å®ç°æ­¥éª¤</p>

    <ol>
      <li>åˆ›å»ºä¸€ä¸ªDirectoryå¯¹è±¡ï¼ŒæŒ‡å‘ç´¢å¼•åº“çš„ä½ç½®</li>
      <li>åˆ›å»ºä¸€ä¸ªIndexReaderå¯¹è±¡ï¼Œéœ€è¦æŒ‡å®šDirectoryå¯¹è±¡</li>
      <li>åˆ›å»ºä¸€ä¸ªIndexSearcherå¯¹è±¡ï¼Œéœ€è¦æŒ‡å®šIndexReaderå¯¹è±¡</li>
      <li>åˆ›å»ºä¸€ä¸ªTermQueryå¯¹è±¡ï¼Œéœ€è¦æŒ‡å®šæŸ¥è¯¢çš„åŸŸå’ŒæŸ¥è¯¢çš„å…³é”®å­—</li>
      <li>æ‰§è¡ŒæŸ¥è¯¢ï¼Œå¾—åˆ°ä¸€ä¸ªTopDocuså¯¹è±¡</li>
      <li>å–æŸ¥è¯¢ç»“æœçš„æ€»è®°å½•æ•°</li>
      <li>å–æ–‡æ¡£åˆ—è¡¨</li>
      <li>æ‰“å°æ–‡æ¡£ä¸­å†…å®¹</li>
      <li>å…³é—­IndexReaderå¯¹è±¡</li>
    </ol>
  </li>
  <li>
    <p>ä»£ç å®ç°</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">searchIndex</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
  <span class="c1">//1. åˆ›å»ºä¸€ä¸ªDirectoryå¯¹è±¡ï¼ŒæŒ‡å‘ç´¢å¼•åº“çš„ä½ç½®</span>
  <span class="c1">//Directory directory = FSDirectory.open(new File("D:\\temp\\index").toPath());</span>
  <span class="nc">Directory</span> <span class="n">directory</span> <span class="o">=</span> <span class="nc">FSDirectory</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="k">new</span> 
                              <span class="nc">File</span><span class="o">(</span><span class="s">"/Users/silhouette/Downloads/temp"</span><span class="o">).</span><span class="na">toPath</span><span class="o">());</span>
  <span class="c1">//2. åˆ›å»ºä¸€ä¸ªIndexReaderå¯¹è±¡ï¼Œéœ€è¦æŒ‡å®šDirectoryå¯¹è±¡</span>
  <span class="nc">IndexReader</span> <span class="n">indexReader</span> <span class="o">=</span> <span class="nc">DirectoryReader</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="n">directory</span><span class="o">);</span>
  <span class="c1">//3. åˆ›å»ºä¸€ä¸ªIndexSearcherå¯¹è±¡ï¼Œéœ€è¦æŒ‡å®šIndexReaderå¯¹è±¡</span>
  <span class="nc">IndexSearcher</span> <span class="n">indexSearcher</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IndexSearcher</span><span class="o">(</span><span class="n">indexReader</span><span class="o">);</span>
  <span class="c1">//4. åˆ›å»ºä¸€ä¸ªTermQueryå¯¹è±¡ï¼Œéœ€è¦æŒ‡å®šæŸ¥è¯¢çš„åŸŸå’ŒæŸ¥è¯¢çš„å…³é”®å­—</span>
  <span class="nc">Query</span> <span class="n">query</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TermQuery</span><span class="o">(</span><span class="k">new</span> <span class="nc">Term</span><span class="o">(</span><span class="s">"fileContent"</span><span class="o">,</span><span class="s">"silhouette"</span><span class="o">));</span>
  <span class="c1">//5. æ‰§è¡ŒæŸ¥è¯¢ï¼Œå¾—åˆ°ä¸€ä¸ªTopDocuså¯¹è±¡</span>
  <span class="c1">//ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æŸ¥è¯¢å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æŸ¥è¯¢ç»“æœè¿”å›çš„æœ€å¤§å€¼</span>
  <span class="nc">TopDocs</span> <span class="n">topDocs</span> <span class="o">=</span> <span class="n">indexSearcher</span><span class="o">.</span><span class="na">search</span><span class="o">(</span><span class="n">query</span><span class="o">,</span><span class="mi">10</span><span class="o">);</span>
  <span class="c1">//æŸ¥è¯¢ç»“æœçš„æ€»æ¡æ•°</span>
  <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"æŸ¥è¯¢ç»“æœçš„æ€»æ¡æ•°ï¼š"</span><span class="o">+</span> <span class="n">topDocs</span><span class="o">.</span><span class="na">totalHits</span><span class="o">);</span>
  <span class="c1">//6. å–æŸ¥è¯¢ç»“æœçš„æ€»è®°å½•æ•°</span>
  <span class="k">for</span> <span class="o">(</span><span class="nc">ScoreDoc</span> <span class="n">scoreDoc</span> <span class="o">:</span> <span class="n">topDocs</span><span class="o">.</span><span class="na">scoreDocs</span><span class="o">){</span>
    <span class="c1">//scoreDoc.docå±æ€§å°±æ˜¯documentå¯¹è±¡çš„id</span>
    <span class="c1">//æ ¹æ®documentçš„idæ‰¾åˆ°documentå¯¹è±¡</span>
    <span class="nc">Document</span> <span class="n">document</span> <span class="o">=</span><span class="n">indexSearcher</span><span class="o">.</span><span class="na">doc</span><span class="o">(</span><span class="n">scoreDoc</span><span class="o">.</span><span class="na">doc</span><span class="o">);</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"fileName"</span><span class="o">));</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"fileContent"</span><span class="o">));</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"filePath"</span><span class="o">));</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"fileSize"</span><span class="o">));</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"-------------------------"</span><span class="o">);</span>
   
  <span class="o">}</span>
  <span class="c1">//9. å…³é—­IndexReaderå¯¹è±¡</span>
  <span class="n">indexReader</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="å››åˆ†æå™¨">å››ã€åˆ†æå™¨</h2>

<h4 id="41-åˆ†æå™¨çš„åˆ†è¯æ•ˆæœ">4.1 åˆ†æå™¨çš„åˆ†è¯æ•ˆæœ</h4>

<p>æŸ¥çœ‹<code class="highlighter-rouge">IndexWriterConfig</code>æºç å¯çŸ¥ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯æ ‡å‡†åˆ†è¯å™¨<code class="highlighter-rouge">StandardAnalyzer</code>ã€‚</p>

<ul>
  <li>
    <p>æŸ¥çœ‹åˆ†æå™¨åˆ†åˆ†ææ•ˆæœ</p>

    <ul>
      <li>ä½¿ç”¨Analyzerå¯¹è±¡çš„tokenStreamæ–¹æ³•è¿”å›ä¸€ä¸ªTokenStreamå¯¹è±¡ï¼Œè¯å¯¹è±¡ä¸­åŒ…å«äº†æœ€ç»ˆåˆ†è¯æ•ˆæœ</li>
    </ul>
  </li>
  <li>
    <p>å®ç°æ­¥éª¤</p>

    <ol>
      <li>
        <p>åˆ›å»ºä¸€ä¸ªAnalyzerå¯¹è±¡ï¼ŒStanderAnalyzerå¯¹è±¡</p>
      </li>
      <li>
        <p>ä½¿ç”¨åˆ†æå™¨å¯¹è±¡çš„tokenStreamæ–¹æ³•è·å¾—ä¸€ä¸ªTokenStreamå¯¹è±¡</p>
      </li>
      <li>
        <p>å‘TokenStreamå¯¹è±¡ä¸­è®¾ç½®ä¸€ä¸ªå¼•ç”¨ï¼Œç›¸å½“äºä¸€ä¸ªæŒ‡é’ˆ</p>
      </li>
      <li>
        <p>è°ƒç”¨TokenStreamå¯¹è±¡ä¸­çš„restæ–¹æ³•ï¼Œå¦‚æœä¸è°ƒç”¨æŠ›å¼‚å¸¸</p>
      </li>
      <li>
        <p>ä½¿ç”¨whileå¾ªç¯éå†TokenStreamå¯¹è±¡</p>
      </li>
      <li>
        <p>å…³é—­TokenStreamå¯¹è±¡</p>
      </li>
    </ol>
  </li>
  <li>
    <p>ä»£ç å®ç°</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testTokenStream</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
  <span class="c1">//1.åˆ›å»ºä¸€ä¸ªAnalyzerå¯¹è±¡ï¼ŒStanderAnalyzerå¯¹è±¡</span>
  <span class="nc">Analyzer</span> <span class="n">analyzer</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StandardAnalyzer</span><span class="o">();</span>
  <span class="c1">//2.ä½¿ç”¨åˆ†æå™¨å¯¹è±¡çš„tokenStreamæ–¹æ³•è·å¾—ä¸€ä¸ªTokenStreamå¯¹è±¡</span>
  <span class="c1">//ç¬¬ä¸€ä¸ªå‚æ•°ï¼šåŸŸåï¼Œå¯ä»¥éšä¾¿ç»™ä¸€ä¸ª,ç¬¬äºŒä¸ªå‚æ•°ï¼šè¦åˆ†æçš„æ–‡æœ¬å†…å®¹</span>
  <span class="nc">TokenStream</span> <span class="n">tokenStream</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="na">tokenStream</span><span class="o">(</span><span class="s">"test"</span><span class="o">,</span><span class="s">"The Spring Framework provides"</span><span class="o">+</span>
                          <span class="s">"a comprehensive programming and configuration model."</span><span class="o">);</span>
  <span class="c1">//TokenStream tokenStream = analyzer.tokenStream("",</span>
  <span class="c1">//													"æŸ¥çœ‹IndexWriterConfigçš„æºç å¯çŸ¥ï¼Œé»˜è®¤é‡‡ç”¨æ ‡å‡†åˆ†æå™¨è¿›è¡Œåˆ†è¯è§£æ");</span>
  <span class="c1">//3.å‘TokenStreamå¯¹è±¡ä¸­è®¾ç½®ä¸€ä¸ªå¼•ç”¨ï¼Œç›¸å½“äºä¸€ä¸ªæŒ‡é’ˆ</span>
  <span class="nc">CharTermAttribute</span> <span class="n">charTermAttribute</span> <span class="o">=</span> 
    												<span class="n">tokenStream</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="nc">CharTermAttribute</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
  <span class="c1">//æ·»åŠ ä¸€ä¸ªåç§»é‡çš„å¼•ç”¨ï¼Œè®°å½•äº†å…³é”®è¯çš„å¼€å§‹ä½ç½®ä»¥åŠç»“æŸä½ç½®</span>
  <span class="nc">OffsetAttribute</span> <span class="n">offsetAttribute</span> <span class="o">=</span> <span class="n">tokenStream</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="nc">OffsetAttribute</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
  <span class="c1">//4.è°ƒç”¨TokenStreamå¯¹è±¡ä¸­çš„restæ–¹æ³•ï¼Œå¦‚æœä¸è°ƒç”¨æŠ›å¼‚å¸¸</span>
  <span class="c1">//å°†æŒ‡é’ˆè°ƒæ•´åˆ°åˆ—è¡¨çš„å¤´éƒ¨</span>
  <span class="n">tokenStream</span><span class="o">.</span><span class="na">reset</span><span class="o">();</span>
  <span class="c1">//5.ä½¿ç”¨whileå¾ªç¯éå†TokenStreamå¯¹è±¡</span>
  <span class="k">while</span><span class="o">(</span><span class="n">tokenStream</span><span class="o">.</span><span class="na">incrementToken</span><span class="o">())</span> <span class="o">{</span>
    <span class="c1">//å…³é”®è¯çš„èµ·å§‹ä½ç½®</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"start-&gt;"</span> <span class="o">+</span> <span class="n">offsetAttribute</span><span class="o">.</span><span class="na">startOffset</span><span class="o">());</span>
    <span class="c1">//å–å…³é”®è¯</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">charTermAttribute</span><span class="o">);</span>
    <span class="c1">//ç»“æŸä½ç½®</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"end-&gt;"</span> <span class="o">+</span> <span class="n">offsetAttribute</span><span class="o">.</span><span class="na">endOffset</span><span class="o">());</span>
  <span class="o">}</span>
  <span class="c1">//6.å…³é—­TokenStreamå¯¹è±¡</span>
  <span class="n">tokenStream</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>    </div>

    <blockquote>
      <p>Tipsï¼šå½“åˆ†æè‹±æ–‡æ—¶ï¼Œä¼šå¯¹å•è¯è¿›è¡Œè§£æï¼›ä½†æ˜¯åˆ†æä¸­æ–‡æ—¶ï¼Œè§£æçš„ç«Ÿç„¶æ˜¯ä¸€ä¸ªå­—ä¸€ä¸ªå­—çš„è§£æ</p>
    </blockquote>
  </li>
</ul>

<h4 id="42-ä¸­æ–‡åˆ†æå™¨">4.2 ä¸­æ–‡åˆ†æå™¨</h4>

<ul>
  <li>
    <p>StandardAnalyzerï¼šå°±æ˜¯æŒ‰ç…§ä¸­æ–‡ä¸€ä¸ªå­—ä¸€ä¸ªå­—åœ°è¿›è¡Œåˆ†è¯ã€‚</p>
  </li>
  <li>
    <p>SmartChineseAnalyzerï¼šå¯¹ä¸­æ–‡æ”¯æŒè¾ƒå¥½ï¼Œä½†æ‰©å±•æ€§å·®ï¼Œæ‰©å±•è¯åº“ï¼Œç¦ç”¨è¯åº“å’ŒåŒä¹‰è¯åº“ç­‰ä¸å¥½å¤„ç†</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">IKAnalyzer</code></p>

    <ul>
      <li>
        <p>ä½¿ç”¨æ–¹æ³•ï¼š</p>

        <ul>
          <li>
            <p>æŠŠjaråŒ…æ·»åŠ åˆ°å·¥ç¨‹ä¸­</p>
          </li>
          <li>
            <p>æŠŠé…ç½®æ–‡ä»¶å’Œæ‰©å±•è¯å…¸å’Œåœç”¨è¯è¯å…¸æ·»åŠ åˆ°classpathä¸‹</p>

            <blockquote>
              <p>æ³¨æ„ï¼šhotword.dicå’Œext_stopword.dicæ–‡ä»¶çš„æ ¼å¼ä¸ºUTF-8ï¼Œæ³¨æ„æ˜¯æ— BOM çš„UTF-8 ç¼–ç ã€‚ä¹Ÿå°±æ˜¯è¯´ç¦æ­¢ä½¿ç”¨windowsè®°äº‹æœ¬ç¼–è¾‘æ‰©å±•è¯å…¸æ–‡ä»¶</p>
            </blockquote>
          </li>
        </ul>
      </li>
      <li>
        <p>ä»£ç å®ç°</p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testIKAnalyzer</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
    <span class="c1">//åˆ›å»ºä¸€ä¸ªAnalyzerå¯¹è±¡ï¼ŒStanderAnalyzerå¯¹è±¡</span>
    <span class="nc">Analyzer</span> <span class="n">analyzer</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IKAnalyzer</span><span class="o">();</span>
    <span class="c1">//ä½¿ç”¨åˆ†æå™¨å¯¹è±¡çš„tokenStreamæ–¹æ³•è·å¾—ä¸€ä¸ªTokenStreamå¯¹è±¡</span>
    <span class="c1">//ç¬¬ä¸€ä¸ªå‚æ•°ï¼šåŸŸåï¼Œå¯ä»¥éšä¾¿ç»™ä¸€ä¸ª,ç¬¬äºŒä¸ªå‚æ•°ï¼šè¦åˆ†æçš„æ–‡æœ¬å†…å®¹</span>
    <span class="nc">TokenStream</span> <span class="n">tokenStream</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="na">tokenStream</span><span class="o">(</span><span class="s">""</span><span class="o">,</span> <span class="s">"The Spring Framework â€œ+ 
                                                   "</span><span class="n">é™Œç”Ÿäºº</span> <span class="n">provides</span> <span class="n">a</span> <span class="n">comprehensive</span> <span class="n">programming</span> <span class="o">.</span><span class="err">"</span><span class="o">);</span>
    <span class="c1">//å‘TokenStreamå¯¹è±¡ä¸­è®¾ç½®ä¸€ä¸ªå¼•ç”¨ï¼Œç›¸å½“äºä¸€ä¸ªæŒ‡é’ˆ</span>
    <span class="nc">CharTermAttribute</span> <span class="n">charTermAttribute</span> <span class="o">=</span> 
      <span class="n">tokenStream</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="nc">CharTermAttribute</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="c1">//å°†æŒ‡é’ˆè°ƒæ•´åˆ°åˆ—è¡¨çš„å¤´éƒ¨</span>
    <span class="n">tokenStream</span><span class="o">.</span><span class="na">reset</span><span class="o">();</span>
    <span class="c1">//5.ä½¿ç”¨whileå¾ªç¯éå†TokenStreamå¯¹è±¡</span>
    <span class="k">while</span><span class="o">(</span><span class="n">tokenStream</span><span class="o">.</span><span class="na">incrementToken</span><span class="o">())</span> <span class="o">{</span>
      <span class="c1">//å–å…³é”®è¯</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">charTermAttribute</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="c1">//å…³é—­TokenStreamå¯¹è±¡</span>
    <span class="n">tokenStream</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>        </div>
      </li>
    </ul>

    <blockquote>
      <p>Tipsï¼šè¿è¡Œä¸Šä¾‹ä¼šæŠ¥é”™ï¼šâ€œjava.lang.AbstractMethodError: org.apache.lucene.analysis.Analyzer.createComponents(Ljava/lang/String;)Lorg/apache/lucene/analysis/Analyzer$TokenStreamComponents;â€</p>
    </blockquote>

    <ul>
      <li>
        <p>å‡ºé”™åˆ†æï¼š</p>

        <ul>
          <li>æŸ¥çœ‹IKåˆ†è¯å™¨çš„æºç pom.xmlæ–‡ä»¶å¯çŸ¥ï¼ŒIKåˆ†è¯å™¨æ‰€ä¾èµ–çš„luceneç›¸å…³ç»„ä»¶çš„ç‰ˆæœ¬ä¸º4.7.2ï¼Œè€Œç¤ºä¾‹ä½¿ç”¨çš„Luceneç‰ˆæœ¬æ˜¯7.4.0ã€‚ä¸¤è€…ç‰ˆæœ¬ä¸åŒï¼Œå¯¼è‡´æŠ¥é”™ã€‚</li>
          <li>è§£å†³æ–¹æ³•ï¼šä»ç½‘ä¸Šæ‰¾äº†ä¸€ä¸ªæ”¯æŒlucene 7.4.0çš„ikåˆ†è¯å™¨çš„jaråŒ…ï¼Œä¿æŒç‰ˆæœ¬ä¸€è‡´ã€‚ç„¶åå°†è¯¥jaråŒ…å¯¼å…¥åˆ°é¡¹ç›®ä¸­å³å¯</li>
        </ul>
      </li>
      <li>
        <p>ä½¿ç”¨IKAnalyzeråˆ†æå™¨åˆ›å»ºç´¢å¼•</p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">createIndex</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
  <span class="c1">// 1. åˆ›å»ºä¸€ä¸ª Director å¯¹è±¡ï¼ŒæŒ‡å®šç´¢å¼•åº“ä¿å­˜çš„ä½ç½®,å¯ä»¥æ˜¯ç£ç›˜ï¼Œä¹Ÿå¯ä»¥æ˜¯å†…å­˜</span>
  <span class="nc">Directory</span> <span class="n">directory</span> <span class="o">=</span> <span class="nc">FSDirectory</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"D:\\temp\\index"</span><span class="o">).</span><span class="na">toPath</span><span class="o">());</span>
  <span class="c1">//2. åŸºäºDirectoryå¯¹è±¡åˆ›å»ºä¸€ä¸ªIndexWriterå¯¹è±¡</span>
  <span class="nc">IndexWriterConfig</span> <span class="n">config</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IndexWriterConfig</span><span class="o">(</span><span class="k">new</span> <span class="nc">IKAnalyzer</span><span class="o">());</span>
  <span class="nc">IndexWriter</span> <span class="n">indexWriter</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IndexWriter</span><span class="o">(</span><span class="n">directory</span><span class="o">,</span><span class="n">config</span><span class="o">);</span>
  <span class="c1">//3. è¯»å–ç£ç›˜ä¸Šçš„æ–‡ä»¶ï¼Œå¯¹åº”æ¯ä¸ªæ–‡ä»¶åˆ›å»ºä¸€ä¸ªæ–‡æ¡£å¯¹è±¡</span>
  <span class="nc">File</span> <span class="n">dir</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"D:\\temp\\searchsource"</span><span class="o">);</span><span class="c1">//åŸå§‹æ–‡æ¡£çš„è·¯å¾„</span>
  <span class="nc">File</span><span class="o">[]</span> <span class="n">files</span> <span class="o">=</span> <span class="n">dir</span><span class="o">.</span><span class="na">listFiles</span><span class="o">();</span>
  <span class="k">for</span> <span class="o">(</span><span class="nc">File</span> <span class="n">file</span> <span class="o">:</span> <span class="n">files</span><span class="o">){</span>
      <span class="nc">String</span> <span class="n">fileName</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="na">getName</span><span class="o">();</span> <span class="c1">//æ–‡ä»¶å</span>
      <span class="nc">String</span> <span class="n">fileContent</span> <span class="o">=</span> <span class="nc">FileUtils</span><span class="o">.</span><span class="na">readFileToString</span><span class="o">(</span><span class="n">file</span><span class="o">);</span><span class="c1">//æ–‡ä»¶å†…å®¹</span>
      <span class="nc">String</span> <span class="n">filePath</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="na">getPath</span><span class="o">();</span><span class="c1">//æ–‡ä»¶è·¯å¾„</span>
      <span class="kt">long</span> <span class="n">fileSize</span> <span class="o">=</span> <span class="nc">FileUtils</span><span class="o">.</span><span class="na">sizeOf</span><span class="o">(</span><span class="n">file</span><span class="o">);</span><span class="c1">//æ–‡ä»¶çš„å¤§å°</span>
      <span class="c1">//åˆ›å»ºæ–‡ä»¶ååŸŸField ï¼ˆåŸŸçš„åç§°ã€åŸŸçš„å†…å®¹ã€æ˜¯å¦å­˜å‚¨ï¼‰</span>
      <span class="nc">Field</span> <span class="n">fileNameField</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TextField</span><span class="o">(</span><span class="s">"fileName"</span><span class="o">,</span><span class="n">fileName</span><span class="o">,</span><span class="nc">Field</span><span class="o">.</span><span class="na">Store</span><span class="o">.</span><span class="na">YES</span><span class="o">);</span>
      <span class="nc">Field</span> <span class="n">fileContentField</span> <span class="o">=</span> <span class="k">new</span> 
                        <span class="nc">TextField</span><span class="o">(</span><span class="s">"fileContent"</span><span class="o">,</span><span class="n">fileContent</span><span class="o">,</span><span class="nc">Field</span><span class="o">.</span><span class="na">Store</span><span class="o">.</span><span class="na">YES</span><span class="o">);</span>
      <span class="nc">Field</span> <span class="n">filePathField</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TextField</span><span class="o">(</span><span class="s">"filePath"</span><span class="o">,</span><span class="n">filePath</span><span class="o">,</span><span class="nc">Field</span><span class="o">.</span><span class="na">Store</span><span class="o">.</span><span class="na">YES</span><span class="o">);</span>
      <span class="nc">Field</span> <span class="n">fileSizeField</span> <span class="o">=</span> <span class="k">new</span> 
                  <span class="nc">TextField</span><span class="o">(</span><span class="s">"fileSize"</span><span class="o">,</span><span class="nc">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">fileSize</span><span class="o">),</span><span class="nc">Field</span><span class="o">.</span><span class="na">Store</span><span class="o">.</span><span class="na">YES</span><span class="o">);</span>
      <span class="c1">//4.åˆ›å»ºdocumentå¯¹è±¡</span>
      <span class="nc">Document</span> <span class="n">document</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Document</span><span class="o">();</span>
      <span class="n">document</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">fileNameField</span><span class="o">);</span>
      <span class="n">document</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">fileContentField</span><span class="o">);</span>
      <span class="n">document</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">filePathField</span><span class="o">);</span>
      <span class="n">document</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">fileSizeField</span><span class="o">);</span>
      <span class="c1">//5.åˆ›å»ºç´¢å¼•ï¼Œå¹¶å†™å…¥ç´¢å¼•åº“</span>
      <span class="n">indexWriter</span><span class="o">.</span><span class="na">addDocument</span><span class="o">(</span><span class="n">document</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="c1">//6. å…³é—­indexWriterå¯¹è±¡</span>
  <span class="n">indexWriter</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
</ul>

<h2 id="äº”ç´¢å¼•åº“çš„ç»´æŠ¤">äº”ã€ç´¢å¼•åº“çš„ç»´æŠ¤</h2>

<h4 id="51-æ·»åŠ ç´¢å¼•åº“">5.1 æ·»åŠ ç´¢å¼•åº“</h4>

<ul>
  <li>
    <p>FieldåŸŸçš„å±æ€§</p>

    <ul>
      <li>æ˜¯å¦åˆ†æï¼šæ˜¯å¦å¯¹åŸŸçš„å†…å®¹è¿›è¡Œåˆ†åˆ†è¯å¤„ç†ã€‚å‰ææ˜¯æˆ‘ä»¬è¦å¯¹åŸŸçš„å†…å®¹è¿›è¡ŒæŸ¥è¯¢</li>
      <li>æ˜¯å¦ç´¢å¼•ï¼šå°†Fieldåˆ†æåçš„è¯æˆ–è€…æ•´ä¸ªFieldè¿›è¡Œç´¢å¼•ï¼Œåªæœ‰ç´¢å¼•æˆ¿å¯æœç´¢åˆ°ã€‚</li>
      <li>æ˜¯å¦å­˜å‚¨ï¼šå°†Fieldå€¼å­˜å‚¨éƒ½æ–‡æ¡£ä¸­ï¼Œå­˜å‚¨åœ¨æ–‡æ¡£ä¸­çš„Fieldæ‰å¯ä»¥ä»Documentä¸­è·å–ã€‚</li>
    </ul>
  </li>
  <li>
    <p>å¸¸è§å±æ€§</p>

    <table>
      <thead>
        <tr>
          <th>Fieldç±»</th>
          <th>æ•°æ®ç±»å‹</th>
          <th>Analyzed  æ˜¯å¦åˆ†æ</th>
          <th>Indexed  æ˜¯å¦ç´¢å¼•</th>
          <th>Stored  æ˜¯å¦å­˜å‚¨</th>
          <th>è¯´æ˜</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>StringField(FieldName,  FieldValue,Store.YES))</td>
          <td>å­—ç¬¦ä¸²</td>
          <td>N</td>
          <td>Y</td>
          <td>Yæˆ–N</td>
          <td>è¿™ä¸ªFieldç”¨æ¥æ„å»ºä¸€ä¸ªå­—ç¬¦ä¸²Fieldï¼Œä½†æ˜¯ä¸ä¼šè¿›è¡Œåˆ†æï¼Œä¼šå°†æ•´ä¸ªä¸²å­˜å‚¨åœ¨ç´¢å¼•ä¸­ï¼Œæ¯”å¦‚(è®¢å•å·,å§“åç­‰)  æ˜¯å¦å­˜å‚¨åœ¨æ–‡æ¡£ä¸­ç”¨Store.YESæˆ–Store.NOå†³å®š</td>
        </tr>
        <tr>
          <td>LongPoint(String name, longâ€¦ point)</td>
          <td>Longå‹</td>
          <td>Y</td>
          <td>Y</td>
          <td>N</td>
          <td>å¯ä»¥ä½¿ç”¨LongPointã€IntPointç­‰ç±»å‹å­˜å‚¨æ•°å€¼ç±»å‹çš„æ•°æ®ã€‚è®©æ•°å€¼ç±»å‹å¯ä»¥è¿›è¡Œç´¢å¼•ã€‚ä½†æ˜¯ä¸èƒ½å­˜å‚¨æ•°æ®ï¼Œå¦‚æœæƒ³å­˜å‚¨æ•°æ®è¿˜éœ€è¦ä½¿ç”¨StoredFieldã€‚</td>
        </tr>
        <tr>
          <td>StoredField(FieldName, FieldValue)</td>
          <td>é‡è½½æ–¹æ³•ï¼Œæ”¯æŒå¤šç§ç±»å‹</td>
          <td>N</td>
          <td>N</td>
          <td>Y</td>
          <td>è¿™ä¸ªFieldç”¨æ¥æ„å»ºä¸åŒç±»å‹Field  ä¸åˆ†æï¼Œä¸ç´¢å¼•ï¼Œä½†è¦Fieldå­˜å‚¨åœ¨æ–‡æ¡£ä¸­</td>
        </tr>
        <tr>
          <td>TextField(FieldName, FieldValue, Store.NO)  æˆ–  TextField(FieldName, reader)</td>
          <td>å­—ç¬¦ä¸²  æˆ–  æµ</td>
          <td>Y</td>
          <td>Y</td>
          <td>Yæˆ–N</td>
          <td>å¦‚æœæ˜¯ä¸€ä¸ªReader, luceneçŒœæµ‹å†…å®¹æ¯”è¾ƒå¤š,ä¼šé‡‡ç”¨Unstoredçš„ç­–ç•¥.</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p>æ·»åŠ æ–‡æ¡£ä»£ç å®ç°</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">addDocument</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="c1">//ç´¢å¼•åº“å­˜æ”¾è·¯å¾„</span>
    <span class="nc">Directory</span> <span class="n">directory</span> <span class="o">=</span> <span class="nc">FSDirectory</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"D:\\temp\\index"</span><span class="o">).</span><span class="na">toPath</span><span class="o">());</span>
    <span class="nc">IndexWriterConfig</span> <span class="n">config</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IndexWriterConfig</span><span class="o">(</span><span class="k">new</span> <span class="nc">IKAnalyzer</span><span class="o">());</span>
    <span class="c1">//åˆ›å»ºä¸€ä¸ªindexwriterå¯¹è±¡</span>
    <span class="nc">IndexWriter</span> <span class="n">indexWriter</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IndexWriter</span><span class="o">(</span><span class="n">directory</span><span class="o">,</span> <span class="n">config</span><span class="o">);</span>
    <span class="c1">//åˆ›å»ºä¸€ä¸ªDocumentå¯¹è±¡</span>
    <span class="nc">Document</span> <span class="n">document</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Document</span><span class="o">();</span>
    <span class="c1">//å‘documentå¯¹è±¡ä¸­æ·»åŠ åŸŸã€‚</span>
    <span class="c1">//ä¸åŒçš„documentå¯ä»¥æœ‰ä¸åŒçš„åŸŸï¼ŒåŒä¸€ä¸ªdocumentå¯ä»¥æœ‰ç›¸åŒçš„åŸŸã€‚</span>
    <span class="n">document</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">TextField</span><span class="o">(</span><span class="s">"filename"</span><span class="o">,</span> <span class="s">"æ–°æ·»åŠ çš„æ–‡æ¡£"</span><span class="o">,</span> <span class="nc">Field</span><span class="o">.</span><span class="na">Store</span><span class="o">.</span><span class="na">YES</span><span class="o">));</span>
    <span class="n">document</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">TextField</span><span class="o">(</span><span class="s">"content"</span><span class="o">,</span> <span class="s">"æ–°æ·»åŠ çš„æ–‡æ¡£çš„å†…å®¹"</span><span class="o">,</span> <span class="nc">Field</span><span class="o">.</span><span class="na">Store</span><span class="o">.</span><span class="na">NO</span><span class="o">));</span>
    <span class="c1">//LongPointåˆ›å»ºç´¢å¼•</span>
    <span class="n">document</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">LongPoint</span><span class="o">(</span><span class="s">"size"</span><span class="o">,</span> <span class="mi">1000</span><span class="n">l</span><span class="o">));</span>
    <span class="c1">//StoreFieldå­˜å‚¨æ•°æ®</span>
    <span class="n">document</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">StoredField</span><span class="o">(</span><span class="s">"size"</span><span class="o">,</span> <span class="mi">1000</span><span class="n">l</span><span class="o">));</span>
    <span class="c1">//ä¸éœ€è¦åˆ›å»ºç´¢å¼•çš„å°±ä½¿ç”¨StoreFieldå­˜å‚¨</span>
    <span class="n">document</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">StoredField</span><span class="o">(</span><span class="s">"path"</span><span class="o">,</span> <span class="s">"d:/temp/1.txt"</span><span class="o">));</span>
    <span class="c1">//æ·»åŠ æ–‡æ¡£åˆ°ç´¢å¼•åº“</span>
    <span class="n">indexWriter</span><span class="o">.</span><span class="na">addDocument</span><span class="o">(</span><span class="n">document</span><span class="o">);</span>
    <span class="c1">//å…³é—­indexwriter</span>
    <span class="n">indexWriter</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="52-åˆ é™¤ç´¢å¼•åº“">5.2 åˆ é™¤ç´¢å¼•åº“</h4>

<ul>
  <li>
    <p>åˆ é™¤å…¨éƒ¨ç´¢å¼•</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">deleteAllIndex</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
		<span class="nc">IndexWriter</span> <span class="n">indexWriter</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IndexWriter</span><span class="o">(</span><span class="nc">FSDirectory</span><span class="o">.</span><span class="na">open</span><span class="o">(</span>
      						<span class="k">new</span> <span class="nf">File</span><span class="o">(</span><span class="s">"D:\\temp\\index"</span><span class="o">).</span><span class="na">toPath</span><span class="o">()),</span>
                 <span class="k">new</span> <span class="nf">IndexWriterConfig</span><span class="o">(</span><span class="k">new</span> <span class="nc">IKAnalyzer</span><span class="o">()));</span>
		<span class="c1">//åˆ é™¤å…¨éƒ¨ç´¢å¼•</span>
		<span class="n">indexWriter</span><span class="o">.</span><span class="na">deleteAll</span><span class="o">();</span>
		<span class="c1">//å…³é—­indexwriter</span>
		<span class="n">indexWriter</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>    </div>

    <blockquote>
      <p>æ³¨æ„ï¼šå°†ç´¢å¼•ç›®å½•çš„ç´¢å¼•ä¿¡æ¯å…¨éƒ¨åˆ é™¤ï¼Œç›´æ¥å½»åº•åˆ é™¤ï¼Œæ— æ³•æ¢å¤ã€‚</p>
    </blockquote>
  </li>
  <li>
    <p>æŒ‡å®šæŸ¥è¯¢æ¡ä»¶åˆ é™¤</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">deleteIndexByQuery</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
		<span class="nc">IndexWriter</span> <span class="n">indexWriter</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IndexWriter</span><span class="o">(</span><span class="nc">FSDirectory</span><span class="o">.</span><span class="na">open</span><span class="o">(</span>
      						     <span class="k">new</span> <span class="nf">File</span><span class="o">(</span><span class="s">"D:\\temp\\index"</span><span class="o">).</span><span class="na">toPath</span><span class="o">()),</span>
                       <span class="k">new</span> <span class="nf">IndexWriterConfig</span><span class="o">(</span><span class="k">new</span> <span class="nc">IKAnalyzer</span><span class="o">()));</span>
		<span class="c1">//åˆ›å»ºä¸€ä¸ªæŸ¥è¯¢æ¡ä»¶</span>
		<span class="nc">Query</span> <span class="n">query</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TermQuery</span><span class="o">(</span><span class="k">new</span> <span class="nc">Term</span><span class="o">(</span><span class="s">"filename"</span><span class="o">,</span> <span class="s">"apache"</span><span class="o">));</span>
		<span class="c1">//æ ¹æ®æŸ¥è¯¢æ¡ä»¶åˆ é™¤</span>
		<span class="n">indexWriter</span><span class="o">.</span><span class="na">deleteDocuments</span><span class="o">(</span><span class="n">query</span><span class="o">);</span>
		<span class="c1">//å…³é—­indexwriter</span>
		<span class="n">indexWriter</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="53-ä¿®æ”¹ç´¢å¼•åº“">5.3 ä¿®æ”¹ç´¢å¼•åº“</h4>

<ul>
  <li>
    <p>ä¿®æ”¹ç´¢å¼•åº“çš„åŸç†å°±æ˜¯<code class="highlighter-rouge">å…ˆåˆ é™¤åæ·»åŠ </code></p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">updateDocument</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
      <span class="nc">IndexWriter</span> <span class="n">indexWriter</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IndexWriter</span><span class="o">(</span><span class="nc">FSDirectory</span><span class="o">.</span><span class="na">open</span><span class="o">(</span>
      						     <span class="k">new</span> <span class="nf">File</span><span class="o">(</span><span class="s">"D:\\temp\\index"</span><span class="o">).</span><span class="na">toPath</span><span class="o">()),</span>
                       <span class="k">new</span> <span class="nf">IndexWriterConfig</span><span class="o">(</span><span class="k">new</span> <span class="nc">IKAnalyzer</span><span class="o">()));</span>
  		<span class="c1">//åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡æ¡£å¯¹è±¡</span>
        <span class="nc">Document</span> <span class="n">document</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Document</span><span class="o">();</span>
        <span class="c1">//å‘æ–‡æ¡£å¯¹è±¡ä¸­æ·»åŠ åŸŸ</span>
        <span class="n">document</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">TextField</span><span class="o">(</span><span class="s">"name"</span><span class="o">,</span> <span class="s">"æ›´æ–°ä¹‹åçš„æ–‡æ¡£"</span><span class="o">,</span> <span class="nc">Field</span><span class="o">.</span><span class="na">Store</span><span class="o">.</span><span class="na">YES</span><span class="o">));</span>
        <span class="n">document</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">TextField</span><span class="o">(</span><span class="s">"name1"</span><span class="o">,</span> <span class="s">"æ›´æ–°ä¹‹åçš„æ–‡æ¡£2"</span><span class="o">,</span> <span class="nc">Field</span><span class="o">.</span><span class="na">Store</span><span class="o">.</span><span class="na">YES</span><span class="o">));</span>
        <span class="n">document</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">TextField</span><span class="o">(</span><span class="s">"name2"</span><span class="o">,</span> <span class="s">"æ›´æ–°ä¹‹åçš„æ–‡æ¡£3"</span><span class="o">,</span> <span class="nc">Field</span><span class="o">.</span><span class="na">Store</span><span class="o">.</span><span class="na">YES</span><span class="o">));</span>
        <span class="c1">//æ›´æ–°æ“ä½œ</span>
        <span class="n">indexWriter</span><span class="o">.</span><span class="na">updateDocument</span><span class="o">(</span><span class="k">new</span> <span class="nc">Term</span><span class="o">(</span><span class="s">"name"</span><span class="o">,</span> <span class="s">"spring"</span><span class="o">),</span> <span class="n">document</span><span class="o">);</span>
        <span class="c1">//å…³é—­ç´¢å¼•åº“</span>
        <span class="n">indexWriter</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="å…­luneceç´¢å¼•åº“æŸ¥è¯¢">å…­ã€Luneceç´¢å¼•åº“æŸ¥è¯¢</h2>

<h4 id="61-luceneç´¢å¼•æŸ¥è¯¢">6.1 Luceneç´¢å¼•æŸ¥è¯¢</h4>

<p>å¯¹è¦æœç´¢çš„ä¿¡æ¯åˆ›å»ºQueryæŸ¥è¯¢å¯¹è±¡ï¼ŒLuceneä¼šæ ¹æ®QueryæŸ¥è¯¢å¯¹è±¡ç”Ÿæˆæœ€ç»ˆçš„æŸ¥è¯¢è¯­æ³•ï¼Œç±»ä¼¼å…³ç³»æ•°æ®åº“SQLè¯­æ³•ä¸€æ · Luceneä¹Ÿæœ‰è‡ªå·±çš„æŸ¥è¯¢è¯­æ³•ï¼Œæ¯”å¦‚ï¼šâ€œname:luceneâ€è¡¨ç¤ºæŸ¥è¯¢Fieldçš„nameä¸ºâ€œluceneâ€çš„æ–‡æ¡£å¯¹è±¡ã€‚</p>

<p>å¯é€šè¿‡ä¸¤ç§æ–¹æ³•åˆ›å»ºæŸ¥è¯¢å¯¹è±¡ï¼š</p>

<ul>
  <li>ä½¿ç”¨Luceneæä¾›Queryå­ç±»<code class="highlighter-rouge">TermQuery</code></li>
  <li>ä½¿ç”¨QueryParseè§£ææŸ¥è¯¢è¡¨è¾¾å¼</li>
</ul>

<h4 id="62-termquery">6.2 <strong>TermQuery</strong></h4>

<ul>
  <li>
    <p>TermQueryï¼šæ ¹æ®å…³é”®å­—è¿›è¡ŒæŸ¥è¯¢ï¼Œéœ€è¦æŒ‡å®šè¦æŸ¥è¯¢çš„åŸŸåŠè…°æŸ¥è¯¢çš„å…³é”®è¯</p>
  </li>
  <li>
    <p>ä»£ç æ¼”ç¤º</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testTermQuery</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="nc">Directory</span> <span class="n">directory</span> <span class="o">=</span> <span class="nc">FSDirectory</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"D:\\temp\\index"</span><span class="o">).</span><span class="na">toPath</span><span class="o">());</span>
    <span class="nc">IndexReader</span> <span class="n">indexReader</span> <span class="o">=</span> <span class="nc">DirectoryReader</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="n">directory</span><span class="o">);</span>
    <span class="nc">IndexSearcher</span> <span class="n">indexSearcher</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IndexSearcher</span><span class="o">(</span><span class="n">indexReader</span><span class="o">);</span>
      
    <span class="c1">//åˆ›å»ºæŸ¥è¯¢å¯¹è±¡</span>
    <span class="nc">Query</span> <span class="n">query</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TermQuery</span><span class="o">(</span><span class="k">new</span> <span class="nc">Term</span><span class="o">(</span><span class="s">"content"</span><span class="o">,</span> <span class="s">"lucene"</span><span class="o">));</span>
    <span class="c1">//æ‰§è¡ŒæŸ¥è¯¢</span>
    <span class="nc">TopDocs</span> <span class="n">topDocs</span> <span class="o">=</span> <span class="n">indexSearcher</span><span class="o">.</span><span class="na">search</span><span class="o">(</span><span class="n">query</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
    <span class="c1">//å…±æŸ¥è¯¢åˆ°çš„documentä¸ªæ•°</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"æŸ¥è¯¢ç»“æœæ€»æ•°é‡ï¼š"</span> <span class="o">+</span> <span class="n">topDocs</span><span class="o">.</span><span class="na">totalHits</span><span class="o">);</span>
    <span class="c1">//éå†æŸ¥è¯¢ç»“æœ</span>
    <span class="k">for</span> <span class="o">(</span><span class="nc">ScoreDoc</span> <span class="n">scoreDoc</span> <span class="o">:</span> <span class="n">topDocs</span><span class="o">.</span><span class="na">scoreDocs</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Document</span> <span class="n">document</span> <span class="o">=</span> <span class="n">indexSearcher</span><span class="o">.</span><span class="na">doc</span><span class="o">(</span><span class="n">scoreDoc</span><span class="o">.</span><span class="na">doc</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"fileName:"</span> <span class="o">+</span> <span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"fileName"</span><span class="o">));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"filePath:"</span> <span class="o">+</span> <span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"filePath"</span><span class="o">));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"fileSize:"</span> <span class="o">+</span> <span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"fileSize"</span><span class="o">));</span>
        <span class="c1">//System.out.println("fileContent:" + document.get("fileContent"));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"-----------------åä¸½çš„çš„åˆ†å‰²çº¿"</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="c1">//å…³é—­indexreader</span>
    <span class="n">indexSearcher</span><span class="o">.</span><span class="na">getIndexReader</span><span class="o">().</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="63-wildcardquery">6.3 WildcardQuery</h4>

<ul>
  <li>
    <p>WildcardQuery å¯ä»¥è¿›è¡Œæµ‹è¯•é€šé…ç¬¦æŸ¥è¯¢ï¼Œ<code class="highlighter-rouge">?</code>å¯ä»¥ä»£è¡¨ä»»æ„ä¸€ä¸ªå­—ç¬¦ï¼Œ<code class="highlighter-rouge">*</code>å¯ä»¥ä»»æ„å¤šä¸ªä»»æ„å­—ç¬¦ã€‚</p>
  </li>
  <li>
    <p>ä»£ç æ¼”ç¤º</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testWildcardQuery</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
 		<span class="nc">Directory</span> <span class="n">directory</span> <span class="o">=</span> <span class="nc">FSDirectory</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"/Users/silhouette/Downloads/temp"</span><span class="o">).</span><span class="na">toPath</span><span class="o">());</span>
    <span class="nc">IndexReader</span> <span class="n">indexReader</span> <span class="o">=</span> <span class="nc">DirectoryReader</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="n">directory</span><span class="o">);</span>
    <span class="nc">IndexSearcher</span> <span class="n">indexSearcher</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IndexSearcher</span><span class="o">(</span><span class="n">indexReader</span><span class="o">);</span>
  
    <span class="c1">// åˆ›å»ºæŸ¥è¯¢å¯¹è±¡</span>
    <span class="nc">Query</span> <span class="n">query</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">WildcardQuery</span><span class="o">(</span><span class="k">new</span> <span class="nc">Term</span><span class="o">(</span><span class="s">"title"</span><span class="o">,</span> <span class="s">"*æ™ºèƒ½*"</span><span class="o">));</span>
    <span class="c1">// æœç´¢æ•°æ®</span>
    <span class="nc">TopDocs</span> <span class="n">topDocs</span> <span class="o">=</span> <span class="n">indexSearcher</span><span class="o">.</span><span class="na">search</span><span class="o">(</span><span class="n">query</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
    <span class="c1">// è·å–æ€»æ¡æ•°</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"æœ¬æ¬¡æœç´¢å…±æ‰¾åˆ°"</span> <span class="o">+</span> <span class="n">topDocs</span><span class="o">.</span><span class="na">totalHits</span> <span class="o">+</span> <span class="s">"æ¡æ•°æ®"</span><span class="o">);</span>
    <span class="c1">//éå†æŸ¥è¯¢ç»“æœ</span>
    <span class="k">for</span> <span class="o">(</span><span class="nc">ScoreDoc</span> <span class="n">scoreDoc</span> <span class="o">:</span> <span class="n">topDocs</span><span class="o">.</span><span class="na">scoreDocs</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Document</span> <span class="n">document</span> <span class="o">=</span> <span class="n">indexSearcher</span><span class="o">.</span><span class="na">doc</span><span class="o">(</span><span class="n">scoreDoc</span><span class="o">.</span><span class="na">doc</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"fileName:"</span> <span class="o">+</span> <span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"fileName"</span><span class="o">));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"filePath:"</span> <span class="o">+</span> <span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"filePath"</span><span class="o">));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"fileSize:"</span> <span class="o">+</span> <span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"fileSize"</span><span class="o">));</span>
        <span class="c1">//System.out.println("fileContent:" + document.get("fileContent"));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"-----------------åä¸½çš„çš„åˆ†å‰²çº¿"</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="c1">//å…³é—­indexreader</span>
    <span class="n">indexSearcher</span><span class="o">.</span><span class="na">getIndexReader</span><span class="o">().</span><span class="na">close</span><span class="o">();</span> 
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="64-rangequery">6.4 RangeQuery</h4>

<ul>
  <li>
    <p>RangeQueryï¼šæ•°å€¼èŒƒå›´æŸ¥è¯¢</p>
  </li>
  <li>
    <p>NumericRangeQueryï¼šæ ¹æ®æ•°å€¼èŒƒå›´æŸ¥è¯¢ï¼ˆå¯ä»¥ç”¨æ¥å¯¹é String ç±»å‹çš„ ID è¿›è¡Œç²¾ç¡® çš„æŸ¥æ‰¾ï¼‰</p>
  </li>
  <li>
    <p>ä»£ç æ¼”ç¤º</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testRangeQuery</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
      <span class="nc">Directory</span> <span class="n">directory</span> <span class="o">=</span> <span class="nc">FSDirectory</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"/Users/silhouette/Downloads/temp"</span><span class="o">).</span><span class="na">toPath</span><span class="o">());</span>
    	<span class="nc">IndexReader</span> <span class="n">indexReader</span> <span class="o">=</span> <span class="nc">DirectoryReader</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="n">directory</span><span class="o">);</span>
    	<span class="nc">IndexSearcher</span> <span class="n">indexSearcher</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IndexSearcher</span><span class="o">(</span><span class="n">indexReader</span><span class="o">);</span>
    
  		<span class="c1">//åˆ›å»ºä¸€ä¸ªQueryå¯¹è±¡</span>
      <span class="nc">Query</span> <span class="n">query</span> <span class="o">=</span> <span class="nc">LongPoint</span><span class="o">.</span><span class="na">newRangeQuery</span><span class="o">(</span><span class="s">"size"</span><span class="o">,</span> <span class="mi">0</span><span class="n">l</span><span class="o">,</span> <span class="mi">100</span><span class="n">l</span><span class="o">);</span>
  		<span class="c1">//å‚æ•°ï¼šåŸŸåã€æœ€å°å€¼ã€æœ€å¤§å€¼ã€æ˜¯å¦åŒ…å«æœ€å°å€¼ã€çŸ¥å¦åŒ…å«æœ€å¤§å€¼</span>
  		<span class="c1">//Query query = NumericRangeQuery.newIntRange("size", 1, 2,true, true);</span>
 			<span class="c1">//æ‰§è¡ŒæŸ¥è¯¢</span>
      <span class="nc">TopDocs</span> <span class="n">topDocs</span> <span class="o">=</span> <span class="n">indexSearcher</span><span class="o">.</span><span class="na">search</span><span class="o">(</span><span class="n">query</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"æ€»è®°å½•æ•°ï¼š"</span> <span class="o">+</span> <span class="n">topDocs</span><span class="o">.</span><span class="na">totalHits</span><span class="o">);</span>
      <span class="nc">ScoreDoc</span><span class="o">[]</span> <span class="n">scoreDocs</span> <span class="o">=</span> <span class="n">topDocs</span><span class="o">.</span><span class="na">scoreDocs</span><span class="o">;</span>
      <span class="k">for</span> <span class="o">(</span><span class="nc">ScoreDoc</span> <span class="nl">doc:</span><span class="n">scoreDocs</span><span class="o">){</span>
          <span class="nc">Document</span> <span class="n">document</span> <span class="o">=</span> <span class="n">indexSearcher</span><span class="o">.</span><span class="na">doc</span><span class="o">(</span><span class="n">scoreDoc</span><span class="o">.</span><span class="na">doc</span><span class="o">);</span>
          <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"fileName:"</span> <span class="o">+</span> <span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"fileName"</span><span class="o">));</span>
          <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"filePath:"</span> <span class="o">+</span> <span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"filePath"</span><span class="o">));</span>
          <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"fileSize:"</span> <span class="o">+</span> <span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"fileSize"</span><span class="o">));</span>
          <span class="c1">//System.out.println("fileContent:" + document.get("fileContent"));</span>
          <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"-----------------åä¸½çš„çš„åˆ†å‰²çº¿"</span><span class="o">);</span>
      <span class="o">}</span>
      <span class="n">indexReader</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>      
</code></pre></div>    </div>
  </li>
</ul>

<blockquote>
  <p>Tipsï¼š4.x.xç‰ˆæœ¬æ—¶è¿˜å¯ä»¥ä½¿ç”¨<strong>NumericRangeQuery</strong>ï¼Œä½†æ˜¯æˆ‘ä½¿ç”¨7.4.0ç‰ˆæœ¬æ—¶ï¼Œå‘ç°æ‰¾ä¸åˆ°äº†ï¼Œå·²è¢«æ›¿æ¢äº†ï¼Œå¯ä»¥ä½¿ç”¨<strong>LongPoint.newRangeQuery()</strong>è¿›è¡ŒèŒƒå›´æŸ¥è¯¢</p>
</blockquote>

<h4 id="65-queryparser">6.5 QueryParser</h4>

<ul>
  <li>
    <p>QueryParserï¼šå¯ä»¥å¯¹è¦æŸ¥è¯¢çš„å†…å®¹è¿›è¡Œåˆ†è¯ï¼Œç„¶ååŸºäºåˆ†è¯çš„ç»“æœè¿›è¡ŒæŸ¥è¯¢ã€‚</p>

    <ul>
      <li>
        <p>éœ€è¦æ·»åŠ QueryParserä¾èµ–çš„JaråŒ…</p>

        <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- https://mvnrepository.com/artifact/org.apache.lucene/lucene-queryparser --&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.apache.lucene<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>lucene-queryparser<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>7.4.0<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>
    <p>ä»£ç æ¼”ç¤º</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testQueryParser</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
  		<span class="nc">Directory</span> <span class="n">directory</span> <span class="o">=</span> <span class="nc">FSDirectory</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"/Users/silhouette/Downloads/temp"</span><span class="o">).</span><span class="na">toPath</span><span class="o">());</span>
    	<span class="nc">IndexReader</span> <span class="n">indexReader</span> <span class="o">=</span> <span class="nc">DirectoryReader</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="n">directory</span><span class="o">);</span>
    	<span class="nc">IndexSearcher</span> <span class="n">indexSearcher</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IndexSearcher</span><span class="o">(</span><span class="n">indexReader</span><span class="o">);</span>
    
  		<span class="c1">//åˆ›å»ºqueryparserå¯¹è±¡ã€‚ç¬¬ä¸€ä¸ªå‚æ•°é»˜è®¤æœç´¢çš„åŸŸï¼Œç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯åˆ†æå™¨å¯¹è±¡</span>
  		<span class="nc">QueryParser</span> <span class="n">queryParser</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">QueryParser</span><span class="o">(</span><span class="s">"content"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">IKAnalyzer</span><span class="o">());</span>
  		<span class="c1">//ä½¿ç”¨QueryPaserå¯¹è±¡åˆ›å»ºä¸€ä¸ªQueryå¯¹è±¡</span>
      <span class="nc">Query</span> <span class="n">query</span> <span class="o">=</span> <span class="n">queryParser</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s">"luceneæ˜¯ä¸€ä¸ªJavaå¼€å‘çš„å…¨æ–‡æ£€ç´¢å·¥å…·åŒ…"</span><span class="o">);</span>
			<span class="c1">//æ‰§è¡ŒæŸ¥è¯¢</span>
      <span class="nc">TopDocs</span> <span class="n">topDocs</span> <span class="o">=</span> <span class="n">indexSearcher</span><span class="o">.</span><span class="na">search</span><span class="o">(</span><span class="n">query</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"æ€»è®°å½•æ•°ï¼š"</span> <span class="o">+</span> <span class="n">topDocs</span><span class="o">.</span><span class="na">totalHits</span><span class="o">);</span>
      <span class="nc">ScoreDoc</span><span class="o">[]</span> <span class="n">scoreDocs</span> <span class="o">=</span> <span class="n">topDocs</span><span class="o">.</span><span class="na">scoreDocs</span><span class="o">;</span>
      <span class="k">for</span> <span class="o">(</span><span class="nc">ScoreDoc</span> <span class="nl">doc:</span><span class="n">scoreDocs</span><span class="o">){</span>
          <span class="nc">Document</span> <span class="n">document</span> <span class="o">=</span> <span class="n">indexSearcher</span><span class="o">.</span><span class="na">doc</span><span class="o">(</span><span class="n">scoreDoc</span><span class="o">.</span><span class="na">doc</span><span class="o">);</span>
          <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"fileName:"</span> <span class="o">+</span> <span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"fileName"</span><span class="o">));</span>
          <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"filePath:"</span> <span class="o">+</span> <span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"filePath"</span><span class="o">));</span>
          <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"fileSize:"</span> <span class="o">+</span> <span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"fileSize"</span><span class="o">));</span>
          <span class="c1">//System.out.println("fileContent:" + document.get("fileContent"));</span>
          <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"-----------------åä¸½çš„çš„åˆ†å‰²çº¿"</span><span class="o">);</span>
      <span class="o">}</span>
      <span class="n">indexReader</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>      
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="66-ç»„åˆæŸ¥è¯¢">6.6 ç»„åˆæŸ¥è¯¢</h4>

<ul>
  <li>
    <p>å¸ƒå°”æŸ¥è¯¢æœ¬èº«æ²¡æœ‰æŸ¥è¯¢æ¡ä»¶ï¼Œå¯ä»¥æŠŠå…¶å®ƒæŸ¥è¯¢é€šè¿‡é€»è¾‘è¿ç®—è¿›è¡Œç»„åˆï¼Œ Occur.MUST è¡¨ç¤ºäº¤é›†ï¼ŒOccur.SHOULD è¡¨ç¤ºå¹¶é›†ï¼ŒOccur.MUST_NOT è¡¨ç¤ºéã€‚</p>
  </li>
  <li>
    <p>ä»£ç æ¼”ç¤º</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testGroupQuery</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
 		 <span class="nc">Directory</span> <span class="n">directory</span> <span class="o">=</span> <span class="nc">FSDirectory</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"/Users/silhouette/Downloads/temp"</span><span class="o">).</span><span class="na">toPath</span><span class="o">());</span>
     <span class="nc">IndexReader</span> <span class="n">indexReader</span> <span class="o">=</span> <span class="nc">DirectoryReader</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="n">directory</span><span class="o">);</span>
     <span class="nc">IndexSearcher</span> <span class="n">indexSearcher</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IndexSearcher</span><span class="o">(</span><span class="n">indexReader</span><span class="o">);</span>
    		
  	 <span class="c1">// åˆ›å»ºæŸ¥è¯¢å¯¹è±¡</span>
		 <span class="nc">Query</span> <span class="n">query1</span> <span class="o">=</span> <span class="nc">NumericRangeQuery</span><span class="o">.</span><span class="na">newIntRange</span><span class="o">(</span><span class="s">"id"</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span><span class="kc">true</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
		 <span class="nc">Query</span> <span class="n">query2</span> <span class="o">=</span> <span class="nc">NumericRangeQuery</span><span class="o">.</span><span class="na">newIntRange</span><span class="o">(</span><span class="s">"id"</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span><span class="kc">true</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
		 <span class="c1">// åˆ›å»ºå¸ƒå°”æŸ¥è¯¢çš„å¯¹è±¡</span>
		 <span class="nc">BooleanQuery</span> <span class="n">query</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BooleanQuery</span><span class="o">();</span>
		 <span class="c1">// ç»„åˆå…¶å®ƒæŸ¥è¯¢</span>
		 <span class="n">query</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">query1</span><span class="o">,</span> <span class="nc">Occur</span><span class="o">.</span><span class="na">MUST_NOT</span><span class="o">);</span>
		 <span class="n">query</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">query2</span><span class="o">,</span> <span class="nc">Occur</span><span class="o">.</span><span class="na">SHOULD</span><span class="o">);</span>
    
  	 <span class="c1">//æ‰§è¡ŒæŸ¥è¯¢</span>
      <span class="nc">TopDocs</span> <span class="n">topDocs</span> <span class="o">=</span> <span class="n">indexSearcher</span><span class="o">.</span><span class="na">search</span><span class="o">(</span><span class="n">query</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"æ€»è®°å½•æ•°ï¼š"</span> <span class="o">+</span> <span class="n">topDocs</span><span class="o">.</span><span class="na">totalHits</span><span class="o">);</span>
      <span class="nc">ScoreDoc</span><span class="o">[]</span> <span class="n">scoreDocs</span> <span class="o">=</span> <span class="n">topDocs</span><span class="o">.</span><span class="na">scoreDocs</span><span class="o">;</span>
      <span class="k">for</span> <span class="o">(</span><span class="nc">ScoreDoc</span> <span class="nl">doc:</span><span class="n">scoreDocs</span><span class="o">){</span>
          <span class="nc">Document</span> <span class="n">document</span> <span class="o">=</span> <span class="n">indexSearcher</span><span class="o">.</span><span class="na">doc</span><span class="o">(</span><span class="n">scoreDoc</span><span class="o">.</span><span class="na">doc</span><span class="o">);</span>
          <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"fileName:"</span> <span class="o">+</span> <span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"fileName"</span><span class="o">));</span>
          <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"filePath:"</span> <span class="o">+</span> <span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"filePath"</span><span class="o">));</span>
          <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"fileSize:"</span> <span class="o">+</span> <span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"fileSize"</span><span class="o">));</span>
          <span class="c1">//System.out.println("fileContent:" + document.get("fileContent"));</span>
          <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"-----------------åä¸½çš„çš„åˆ†å‰²çº¿"</span><span class="o">);</span>
      <span class="o">}</span>
      <span class="n">indexReader</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="ä¸ƒluceneçš„é«˜çº§ä½¿ç”¨">ä¸ƒã€Luceneçš„é«˜çº§ä½¿ç”¨</h2>

<h4 id="71-é«˜äº®æ˜¾ç¤º">7.1 é«˜äº®æ˜¾ç¤º</h4>

<ul>
  <li>
    <p>é«˜äº®æ˜¾ç¤ºçš„ä¸»è¦å®ç°åŸç†åœ¨äºï¼Œä¸ºæ‰€æœ‰çš„å…³é”®å­—æ·»åŠ ä¸€ä¸ªHTMLæ ‡ç­¾ï¼Œé€šè¿‡æ”¹æ ‡ç­¾æ¥è®¾ç½®é«˜äº®ã€‚</p>
  </li>
  <li>
    <p>ä»£ç æ¼”ç¤º</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testHighLighter</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
  	<span class="nc">Directory</span> <span class="n">directory</span> <span class="o">=</span> <span class="nc">FSDirectory</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"/Users/silhouette/Downloads/temp4"</span><span class="o">));</span>
    <span class="nc">IndexReader</span> <span class="n">indexReader</span> <span class="o">=</span> <span class="nc">DirectoryReader</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="n">directory</span><span class="o">);</span>
    <span class="nc">IndexSearcher</span> <span class="n">indexSearcher</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IndexSearcher</span><span class="o">(</span><span class="n">indexReader</span><span class="o">);</span>
  
    <span class="c1">//åˆ›å»ºqueryparserå¯¹è±¡ã€‚ç¬¬ä¸€ä¸ªå‚æ•°é»˜è®¤æœç´¢çš„åŸŸï¼Œç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯åˆ†æå™¨å¯¹è±¡</span>
    <span class="nc">QueryParser</span> <span class="n">queryParser</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">QueryParser</span><span class="o">(</span><span class="nc">Version</span><span class="o">.</span><span class="na">LUCENE_47</span><span class="o">,</span><span class="s">"fileContent"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">IKAnalyzer</span><span class="o">());</span>
    <span class="c1">//ä½¿ç”¨QueryPaserå¯¹è±¡åˆ›å»ºä¸€ä¸ªQueryå¯¹è±¡</span>
    <span class="nc">Query</span> <span class="n">query</span> <span class="o">=</span> <span class="n">queryParser</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s">"freemarker"</span><span class="o">);</span>
  
    <span class="c1">// æ ¼å¼åŒ–å™¨</span>
    <span class="nc">Formatter</span> <span class="n">formatter</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SimpleHTMLFormatter</span><span class="o">(</span><span class="s">"&lt;em&gt;"</span><span class="o">,</span><span class="s">"&lt;/em&gt;"</span><span class="o">);</span>
    <span class="nc">Scorer</span> <span class="n">scorer</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">QueryScorer</span><span class="o">(</span><span class="n">query</span><span class="o">);</span>
    <span class="c1">// å‡†å¤‡é«˜äº®å·¥å…·</span>
    <span class="nc">Highlighter</span> <span class="n">highlighter</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Highlighter</span><span class="o">(</span><span class="n">formatter</span><span class="o">,</span><span class="n">scorer</span><span class="o">);</span>
  
    <span class="c1">//æ‰§è¡ŒæŸ¥è¯¢</span>
    <span class="nc">TopDocs</span> <span class="n">topDocs</span> <span class="o">=</span> <span class="n">indexSearcher</span><span class="o">.</span><span class="na">search</span><span class="o">(</span><span class="n">query</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"æ€»è®°å½•æ•°ï¼š"</span> <span class="o">+</span> <span class="n">topDocs</span><span class="o">.</span><span class="na">totalHits</span><span class="o">);</span>
    <span class="nc">ScoreDoc</span><span class="o">[]</span> <span class="n">scoreDocs</span> <span class="o">=</span> <span class="n">topDocs</span><span class="o">.</span><span class="na">scoreDocs</span><span class="o">;</span>
    <span class="k">for</span> <span class="o">(</span><span class="nc">ScoreDoc</span> <span class="nl">doc:</span><span class="n">scoreDocs</span><span class="o">){</span>
      <span class="c1">//å–æ–‡æ¡£id</span>
      <span class="kt">int</span> <span class="n">docId</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="na">doc</span><span class="o">;</span>
      <span class="c1">//æ ¹æ®idå–æ–‡æ¡£å¯¹è±¡</span>
      <span class="nc">Document</span> <span class="n">document</span> <span class="o">=</span> <span class="n">indexSearcher</span><span class="o">.</span><span class="na">doc</span><span class="o">(</span><span class="n">docId</span><span class="o">);</span>
      <span class="c1">// å¤„ç†æŸ¥è¯¢ç»“æœ</span>
      <span class="nc">String</span> <span class="n">fileContent</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"fileContent"</span><span class="o">);</span>
      <span class="nc">String</span> <span class="n">result</span> <span class="o">=</span> <span class="n">highlighter</span><span class="o">.</span><span class="na">getBestFragment</span><span class="o">(</span><span class="k">new</span> <span class="nc">IKAnalyzer</span><span class="o">(),</span> <span class="s">"fileContent"</span><span class="o">,</span> <span class="n">fileContent</span><span class="o">);</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"result:"</span> <span class="o">+</span> <span class="n">result</span><span class="o">);</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"-----------------åä¸½çš„çš„åˆ†å‰²çº¿"</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="n">indexReader</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>    </div>

    <blockquote>
      <p>Tipsï¼šè¿è¡Œç»“æœå¯çŸ¥ï¼Œæ‰€æœ‰çš„æœç´¢å…³é”®å­—éƒ½è¢«<em>æ ‡ç­¾åŒ…è£¹èµ·æ¥äº†ã€‚æ³¨æ„ï¼Œæ­¤æ¬¡ä½¿ç”¨çš„Luceneçš„ç‰ˆæœ¬æ˜¯<code class="highlighter-rouge">4.7.2</code>ï¼Œå› ä¸ºæˆ‘åœ¨<code class="highlighter-rouge">7.4.0</code>æœªæ‰¾åˆ°å…³äºé«˜äº®çš„æ¥å£æˆ–å®ç°ç±»ã€‚</em></p>
    </blockquote>
  </li>
</ul>

<h4 id="72-æ’åº">7.2 æ’åº</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testQuerySort</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
  	<span class="nc">Directory</span> <span class="n">directory</span> <span class="o">=</span> <span class="nc">FSDirectory</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"/Users/silhouette/Downloads/temp7"</span><span class="o">).</span><span class="na">toPath</span><span class="o">());</span>
    <span class="nc">IndexReader</span> <span class="n">indexReader</span> <span class="o">=</span> <span class="nc">DirectoryReader</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="n">directory</span><span class="o">);</span>
    <span class="nc">IndexSearcher</span> <span class="n">indexSearcher</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IndexSearcher</span><span class="o">(</span><span class="n">indexReader</span><span class="o">);</span>

    <span class="c1">//åˆ›å»ºqueryparserå¯¹è±¡ã€‚ç¬¬ä¸€ä¸ªå‚æ•°é»˜è®¤æœç´¢çš„åŸŸï¼Œç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯åˆ†æå™¨å¯¹è±¡</span>
    <span class="nc">QueryParser</span> <span class="n">queryParser</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">QueryParser</span><span class="o">(</span><span class="s">"fileContent"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">IKAnalyzer</span><span class="o">());</span>
    <span class="c1">//ä½¿ç”¨QueryPaserå¯¹è±¡åˆ›å»ºä¸€ä¸ªQueryå¯¹è±¡</span>
    <span class="nc">Query</span> <span class="n">query</span> <span class="o">=</span> <span class="n">queryParser</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s">"freemarker"</span><span class="o">);</span>

    <span class="c1">// åˆ›å»ºæ’åºå¯¹è±¡ï¼Œfalseå‡åºï¼Œtrueé™åº</span>
    <span class="nc">Sort</span> <span class="n">sort</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Sort</span><span class="o">(</span><span class="k">new</span> <span class="nc">SortField</span><span class="o">(</span><span class="s">"id"</span><span class="o">,</span> <span class="nc">SortField</span><span class="o">.</span><span class="na">Type</span><span class="o">.</span><span class="na">INT</span><span class="o">,</span> <span class="kc">true</span><span class="o">));</span>
    <span class="c1">//æ‰§è¡ŒæŸ¥è¯¢</span>
    <span class="nc">TopDocs</span> <span class="n">topDocs</span> <span class="o">=</span> <span class="n">indexSearcher</span><span class="o">.</span><span class="na">search</span><span class="o">(</span><span class="n">query</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span><span class="n">sort</span><span class="o">);</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"æ€»è®°å½•æ•°ï¼š"</span> <span class="o">+</span> <span class="n">topDocs</span><span class="o">.</span><span class="na">totalHits</span><span class="o">);</span>
    <span class="nc">ScoreDoc</span><span class="o">[]</span> <span class="n">scoreDocs</span> <span class="o">=</span> <span class="n">topDocs</span><span class="o">.</span><span class="na">scoreDocs</span><span class="o">;</span>
    <span class="k">for</span> <span class="o">(</span><span class="nc">ScoreDoc</span> <span class="nl">doc:</span><span class="n">scoreDocs</span><span class="o">){</span>
        <span class="c1">//å–æ–‡æ¡£id</span>
        <span class="kt">int</span> <span class="n">docId</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="na">doc</span><span class="o">;</span>
        <span class="c1">//æ ¹æ®idå–æ–‡æ¡£å¯¹è±¡</span>
        <span class="nc">Document</span> <span class="n">document</span> <span class="o">=</span> <span class="n">indexSearcher</span><span class="o">.</span><span class="na">doc</span><span class="o">(</span><span class="n">docId</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"fileName:"</span> <span class="o">+</span> <span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"fileName"</span><span class="o">));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"filePath:"</span> <span class="o">+</span> <span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"filePath"</span><span class="o">));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"fileSize:"</span> <span class="o">+</span> <span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"fileSize"</span><span class="o">));</span>
        <span class="c1">//System.out.println("fileContent:" + document.get("fileContent"));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"-----------------åä¸½çš„çš„åˆ†å‰²çº¿"</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="n">indexReader</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<h4 id="73-åˆ†é¡µ">7.3 åˆ†é¡µ</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testPageQuery</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
    <span class="c1">//æ¯é¡µæ¡æ•°</span>
    <span class="kt">int</span> <span class="n">pageSize</span> <span class="o">=</span> <span class="mi">2</span><span class="o">;</span>
    <span class="c1">//å½“å‰é¡µç </span>
    <span class="kt">int</span> <span class="n">pageNum</span> <span class="o">=</span> <span class="mi">3</span><span class="o">;</span>
    <span class="c1">//å½“å‰é¡µçš„èµ·å§‹æ¡æ•°</span>
    <span class="kt">int</span> <span class="n">start</span> <span class="o">=</span> <span class="o">(</span><span class="n">pageNum</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span> <span class="o">*</span> <span class="n">pageSize</span><span class="o">;</span>
    <span class="c1">//å½“å‰é¡µçš„ç»“æŸæ¡æ•°</span>
    <span class="kt">int</span> <span class="n">end</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">pageSize</span><span class="o">;</span>

    <span class="nc">Directory</span> <span class="n">directory</span> <span class="o">=</span> <span class="nc">FSDirectory</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"/Users/silhouette/Downloads/temp7"</span><span class="o">).</span><span class="na">toPath</span><span class="o">());</span>
    <span class="nc">IndexReader</span> <span class="n">indexReader</span> <span class="o">=</span> <span class="nc">DirectoryReader</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="n">directory</span><span class="o">);</span>
    <span class="nc">IndexSearcher</span> <span class="n">indexSearcher</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IndexSearcher</span><span class="o">(</span><span class="n">indexReader</span><span class="o">);</span>

    <span class="c1">//åˆ›å»ºqueryparserå¯¹è±¡ã€‚ç¬¬ä¸€ä¸ªå‚æ•°é»˜è®¤æœç´¢çš„åŸŸï¼Œç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯åˆ†æå™¨å¯¹è±¡</span>
    <span class="nc">QueryParser</span> <span class="n">queryParser</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">QueryParser</span><span class="o">(</span><span class="s">"fileContent"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">IKAnalyzer</span><span class="o">());</span>
    <span class="c1">//ä½¿ç”¨QueryPaserå¯¹è±¡åˆ›å»ºä¸€ä¸ªQueryå¯¹è±¡</span>
    <span class="nc">Query</span> <span class="n">query</span> <span class="o">=</span> <span class="n">queryParser</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s">"freemarker"</span><span class="o">);</span>

    <span class="c1">// åˆ›å»ºæ’åºå¯¹è±¡ï¼Œfalseå‡åºï¼Œtrueé™åº</span>
    <span class="nc">Sort</span> <span class="n">sort</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Sort</span><span class="o">(</span><span class="k">new</span> <span class="nc">SortField</span><span class="o">(</span><span class="s">"id"</span><span class="o">,</span> <span class="nc">SortField</span><span class="o">.</span><span class="na">Type</span><span class="o">.</span><span class="na">INT</span><span class="o">,</span> <span class="kc">false</span><span class="o">));</span>
    <span class="c1">//æ‰§è¡ŒæŸ¥è¯¢</span>
    <span class="nc">TopDocs</span> <span class="n">topDocs</span> <span class="o">=</span> <span class="n">indexSearcher</span><span class="o">.</span><span class="na">search</span><span class="o">(</span><span class="n">query</span><span class="o">,</span> <span class="n">end</span><span class="o">,</span><span class="n">sort</span><span class="o">);</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"æ€»è®°å½•æ•°ï¼š"</span> <span class="o">+</span> <span class="n">topDocs</span><span class="o">.</span><span class="na">totalHits</span><span class="o">);</span>
    <span class="nc">ScoreDoc</span><span class="o">[]</span> <span class="n">scoreDocs</span> <span class="o">=</span> <span class="n">topDocs</span><span class="o">.</span><span class="na">scoreDocs</span><span class="o">;</span>
    <span class="c1">//é¿å…æ•°æ®è¶Šç•Œ </span>
    <span class="k">if</span> <span class="o">(</span><span class="n">end</span> <span class="o">&gt;</span> <span class="n">scoreDocs</span><span class="o">.</span><span class="na">length</span><span class="o">){</span>
      <span class="n">end</span> <span class="o">=</span> <span class="n">scoreDocs</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">start</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">end</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
      <span class="nc">ScoreDoc</span> <span class="n">scoreDoc</span> <span class="o">=</span> <span class="n">scoreDocs</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
      <span class="c1">//è·å–æ–‡æ¡£å¯¹è±¡</span>
      <span class="nc">Document</span> <span class="n">document</span> <span class="o">=</span> <span class="n">indexSearcher</span><span class="o">.</span><span class="na">doc</span><span class="o">(</span><span class="n">scoreDoc</span><span class="o">.</span><span class="na">doc</span><span class="o">);</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"fileName:"</span> <span class="o">+</span> <span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"fileName"</span><span class="o">));</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"filePath:"</span> <span class="o">+</span> <span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"filePath"</span><span class="o">));</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"fileSize:"</span> <span class="o">+</span> <span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"fileSize"</span><span class="o">));</span>
      <span class="c1">//System.out.println("fileContent:" + document.get("fileContent"));</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"-----------------åä¸½çš„çš„åˆ†å‰²çº¿"</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="n">indexReader</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<h4 id="74-åŠ æƒç®—æ³•">7.4 åŠ æƒç®—æ³•</h4>

<p>Luceneä¼šå¯¹æœç´¢ç»“æœè¿›è¡Œæ‰“åˆ†ï¼Œç”¨æ¥è¡¨ç¤ºæ–‡æ¡£æ•°æ®ä¸è¯æ¡å…³è”æ€§çš„å¼ºå¼±ï¼Œå¾—åˆ†è¶Šé«˜ï¼Œè¡¨ç¤ºæŸ¥è¯¢çš„åŒ¹é…åº¦å°±è¶Šé«˜ï¼Œæ’åå°±è¶Šé å‰ã€‚</p>

<ul>
  <li>
    <p>åˆ›å»ºç´¢å¼•</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">CreateWeightIndex</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
  	<span class="c1">// åˆ›å»ºä¸€ä¸ª Director å¯¹è±¡ï¼ŒæŒ‡å®šç´¢å¼•åº“ä¿å­˜çš„ä½ç½®,å¯ä»¥æ˜¯ç£ç›˜ï¼Œä¹Ÿå¯ä»¥æ˜¯å†…å­˜</span>
    <span class="nc">Directory</span> <span class="n">directory</span> <span class="o">=</span> <span class="nc">FSDirectory</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"/Users/silhouette/Downloads/temp4"</span><span class="o">));</span>
    <span class="c1">// åŸºäºDirectoryå¯¹è±¡åˆ›å»ºä¸€ä¸ªIndexWriterå¯¹è±¡</span>
    <span class="nc">IndexWriterConfig</span> <span class="n">indexWriterConfig</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IndexWriterConfig</span><span class="o">(</span><span class="nc">Version</span><span class="o">.</span><span class="na">LUCENE_47</span><span class="o">,</span><span class="k">new</span> <span class="nc">IKAnalyzer</span><span class="o">());</span>
    <span class="nc">IndexWriter</span> <span class="n">indexWriter</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IndexWriter</span><span class="o">(</span><span class="n">directory</span><span class="o">,</span><span class="n">indexWriterConfig</span><span class="o">);</span>
  
    <span class="nc">Document</span> <span class="n">document</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Document</span><span class="o">();</span>
    <span class="nc">Random</span> <span class="n">random</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">();</span>
    <span class="c1">// åˆ›å»ºFiledéœ€è¦åˆ¶å®šå­—æ®µçš„åç§°ï¼Œå­—æ®µçš„å†…å®¹ï¼Œè¿˜éœ€è¦è®¾ç½®æ˜¯å¦éœ€è¦å­˜å‚¨</span>
    <span class="nc">IndexableField</span> <span class="n">fieldId</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IntField</span><span class="o">(</span><span class="s">"id"</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="nc">Field</span><span class="o">.</span><span class="na">Store</span><span class="o">.</span><span class="na">YES</span><span class="o">);</span>
    <span class="nc">TextField</span> <span class="n">fieldTitle</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TextField</span><span class="o">(</span><span class="s">"title"</span><span class="o">,</span> <span class="s">"title "</span> <span class="o">+</span> <span class="mi">10</span><span class="o">,</span> <span class="nc">Field</span><span class="o">.</span><span class="na">Store</span><span class="o">.</span><span class="na">YES</span><span class="o">);</span>
  	<span class="c1">//è®¾ç½®åŠ æƒ</span>
    <span class="n">fieldTitle</span><span class="o">.</span><span class="na">setBoost</span><span class="o">(</span><span class="mf">2.0f</span><span class="o">);</span>
    <span class="nc">IndexableField</span> <span class="n">fieldHits</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IntField</span><span class="o">(</span><span class="s">"hits"</span><span class="o">,</span> <span class="n">random</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">1000</span><span class="o">),</span> <span class="nc">Field</span><span class="o">.</span><span class="na">Store</span><span class="o">.</span><span class="na">YES</span><span class="o">);</span>
  
    <span class="c1">// å‘documentä¸­æ·»åŠ å­—æ®µ</span>
    <span class="n">document</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">fieldTitle</span><span class="o">);</span>
    <span class="n">document</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">fieldId</span><span class="o">);</span>
    <span class="n">document</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">fieldHits</span><span class="o">);</span>
    <span class="c1">//æ·»åŠ æ–‡æ¡£</span>
    <span class="n">indexWriter</span><span class="o">.</span><span class="na">addDocument</span><span class="o">(</span><span class="n">document</span><span class="o">);</span>
    <span class="c1">//æäº¤</span>
    <span class="n">indexWriter</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
    <span class="n">indexWriter</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>æŸ¥è¯¢ç´¢å¼•</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
*	ä¿®æ”¹æƒé‡å¹¶é‡æ–°åˆ›å»ºç´¢å¼•ï¼Œç„¶åå†è¿›è¡ŒæŸ¥è¯¢ç´¢å¼•æŸ¥çœ‹æ•ˆæœ
*/</span>
<span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">QueryWeightIndex</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
  	<span class="nc">Directory</span> <span class="n">directory</span> <span class="o">=</span> <span class="nc">FSDirectory</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"/Users/silhouette/Downloads/temp4"</span><span class="o">));</span>
    <span class="nc">IndexReader</span> <span class="n">indexReader</span> <span class="o">=</span> <span class="nc">DirectoryReader</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="n">directory</span><span class="o">);</span>
    <span class="nc">IndexSearcher</span> <span class="n">indexSearcher</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IndexSearcher</span><span class="o">(</span><span class="n">indexReader</span><span class="o">);</span>
  
    <span class="c1">//åˆ›å»ºqueryparserå¯¹è±¡ã€‚ç¬¬ä¸€ä¸ªå‚æ•°é»˜è®¤æœç´¢çš„åŸŸï¼Œç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯åˆ†æå™¨å¯¹è±¡</span>
    <span class="nc">QueryParser</span> <span class="n">queryParser</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">QueryParser</span><span class="o">(</span><span class="nc">Version</span><span class="o">.</span><span class="na">LUCENE_47</span><span class="o">,</span><span class="s">"title"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">IKAnalyzer</span><span class="o">());</span>
    <span class="c1">//ä½¿ç”¨QueryPaserå¯¹è±¡åˆ›å»ºä¸€ä¸ªQueryå¯¹è±¡</span>
    <span class="nc">Query</span> <span class="n">query</span> <span class="o">=</span> <span class="n">queryParser</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s">"title"</span><span class="o">);</span>
  
    <span class="nc">TopDocs</span> <span class="n">topDocs</span> <span class="o">=</span> <span class="n">indexSearcher</span><span class="o">.</span><span class="na">search</span><span class="o">(</span><span class="n">query</span><span class="o">,</span> <span class="mi">20</span><span class="o">);</span>
  
    <span class="nc">ScoreDoc</span><span class="o">[]</span> <span class="n">scoreDocs</span> <span class="o">=</span> <span class="n">topDocs</span><span class="o">.</span><span class="na">scoreDocs</span><span class="o">;</span>
  
    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">scoreDocs</span><span class="o">.</span><span class="na">length</span> <span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
      <span class="nc">Document</span> <span class="n">document</span> <span class="o">=</span> <span class="n">indexSearcher</span><span class="o">.</span><span class="na">doc</span><span class="o">(</span><span class="n">scoreDocs</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">doc</span><span class="o">);</span>
  
      <span class="nc">String</span> <span class="n">id</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"id"</span><span class="o">);</span>
      <span class="nc">String</span> <span class="n">title</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"title"</span><span class="o">);</span>
      <span class="nc">String</span> <span class="n">hits</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"hits"</span><span class="o">);</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">id</span> <span class="o">+</span> <span class="s">"ï¼š"</span> <span class="o">+</span> <span class="n">title</span><span class="o">+</span><span class="s">":"</span><span class="o">+</span><span class="n">hits</span><span class="o">);</span>
    <span class="o">}</span>
  
    <span class="n">indexReader</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<blockquote>
  <p>Tipsï¼šæ­¤ç¤ºä¾‹ä½¿ç”¨çš„Luceneç‰ˆæœ¬æ˜¯æ˜¯<code class="highlighter-rouge">4.7.2</code>ï¼Œåœ¨<code class="highlighter-rouge">7.4.0</code>ä¸Šæœªæ‰¾åˆ°åŠ æƒçš„ç›¸åº”æ–¹æ³•</p>
</blockquote>

:ET